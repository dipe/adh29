[
    {
        "id": "37daec28.284ee4",
        "type": "tab",
        "label": "WoZi",
        "disabled": false,
        "info": ""
    },
    {
        "id": "2ba29887.9266e8",
        "type": "tab",
        "label": "EsZi",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3a471104.edfbae",
        "type": "tab",
        "label": "Treppenhaus",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4d90b497.b5b2ac",
        "type": "tab",
        "label": "Waschküche",
        "disabled": false,
        "info": ""
    },
    {
        "id": "293bb437.fa00bc",
        "type": "tab",
        "label": "Außen",
        "disabled": false,
        "info": ""
    },
    {
        "id": "fc81a32b.bb6db",
        "type": "tab",
        "label": "Hausklima",
        "disabled": false,
        "info": ""
    },
    {
        "id": "2f328ad8.26ca86",
        "type": "tab",
        "label": "Verbrauch",
        "disabled": false,
        "info": ""
    },
    {
        "id": "dac2cb3b.559138",
        "type": "tab",
        "label": "Heizung",
        "disabled": false,
        "info": ""
    },
    {
        "id": "2788b93b.8a2f56",
        "type": "tab",
        "label": "Lüftungsempfehlungen",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d0173d54.941d7",
        "type": "tab",
        "label": "influxdb",
        "disabled": false,
        "info": ""
    },
    {
        "id": "29cd7d28.a2bf92",
        "type": "tab",
        "label": "Testecke",
        "disabled": true,
        "info": ""
    },
    {
        "id": "befdc0fb.ac3d3",
        "type": "subflow",
        "name": "blink",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 160,
                "y": 120,
                "wires": [
                    {
                        "id": "f01a88f1.841248"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 880,
                "y": 260,
                "wires": [
                    {
                        "id": "f01a88f1.841248",
                        "port": 0
                    },
                    {
                        "id": "b6139de2.2f87d",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "74074f6d.94c6d",
        "type": "subflow",
        "name": "detect short long",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 120,
                "wires": [
                    {
                        "id": "d15cd0de.e4d8a"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 860,
                "y": 80,
                "wires": [
                    {
                        "id": "c7393d5d.d251",
                        "port": 0
                    }
                ]
            },
            {
                "x": 860,
                "y": 160,
                "wires": [
                    {
                        "id": "c7393d5d.d251",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "44f6655c.d047bc",
        "type": "subflow",
        "name": "Blink",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "c349b9ff.9dc4c8",
        "type": "mqtt-broker",
        "name": "dipe",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": false,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "c3f84e99.0ea82",
        "type": "mqtt-broker",
        "name": "",
        "broker": "localhost",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": false,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "dc07af4f.71ca1",
        "type": "ui_tab",
        "name": "Wohnzimmer",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "e4ade7a.0cef418",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "dark"
            }
        },
        "site": {
            "name": "[DIPE] Home",
            "hideToolbar": "false",
            "allowSwipe": "true",
            "lockMenu": "false",
            "allowTempTheme": "none",
            "dateFormat": "YYYY-MM-DD",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "1b9713a7.a3a26c",
        "type": "ui_group",
        "name": "Tiffany",
        "tab": "dc07af4f.71ca1",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "3f0994e3.62d76c",
        "type": "ui_group",
        "name": "Szenen",
        "tab": "dc07af4f.71ca1",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "b4675dbc.146e1",
        "type": "ui_group",
        "name": "Leuchter",
        "tab": "dc07af4f.71ca1",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "4a760c5.5eef1f4",
        "type": "ui_tab",
        "name": "Esszimmer",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "740db3e2.8916ac",
        "type": "ui_group",
        "name": "Fensterbank",
        "tab": "dc07af4f.71ca1",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "33913a78.8716a6",
        "type": "ui_group",
        "name": "Klavierlampe",
        "tab": "dc07af4f.71ca1",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "12ecf9a1.9cb126",
        "type": "ui_group",
        "name": "Tisch",
        "tab": "4a760c5.5eef1f4",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "643154e.6b44bac",
        "type": "ui_group",
        "name": "Eckschrank",
        "tab": "4a760c5.5eef1f4",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "aca2d944.6c15c8",
        "type": "ui_group",
        "name": "Szenen",
        "tab": "4a760c5.5eef1f4",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "1c76ef79.75b781",
        "type": "ui_tab",
        "name": "Waschküche",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "8240b43a.1094b8",
        "type": "ui_group",
        "name": "Verlauf",
        "tab": "1c76ef79.75b781",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "e822c4d8.ce3a88",
        "type": "ui_tab",
        "name": "Verbrauch",
        "icon": "dashboard",
        "order": 7,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "48b52eb1.50063",
        "type": "fritzbox-config",
        "name": "",
        "host": "fritz.box",
        "port": "49443",
        "ssl": true,
        "user": "nodered"
    },
    {
        "id": "7e092ea0.4f2d9",
        "type": "ui_group",
        "name": "Aktuell",
        "tab": "1c76ef79.75b781",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "10925253.f46f4e",
        "type": "hangoutsCertificate",
        "clientEmail": "haus-bot@home-hangout.iam.gserviceaccount.com",
        "privateKey": "-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCYNybJAubXeD6C\\nZQlSnhfZcVDgZWo4Yb3xAEz4/T0b5GpjaiO3oVYcdliFhVc+IfjmPPCeVDQvk3g7\\ns5YqG6NdRtvfqMrckUFzKA4DWmGBM+cdteoloTwn37FDxVZCk2ADXw/A++6bhKcl\\nh9hPtbL6UJvj0Vye5yeVjB9v5/l0pbJ3W+OXDEEZsGtYq3RMeKF7ghY00Z7uweiH\\nxoPO0tOZ5kp9Inmwy7Wd0D+OsjGjyEAu0zsvTOAatdeeErsQmfCrz5U13GYGoUbt\\nQfEChBIA1I17D/Pq9YuJXD+hAM7ZrC48zZwwM2HMoRSSRfiux2kfFhNW/d1zglzS\\nazqAs0lZAgMBAAECggEAD7mx6HYj6FqINbMvvIDv9JNKAFbF26OQapWl/hq2fZtS\\nWOkyHbJdqbTZxhiNl/INS2b8ElVfa1NcSmmuH7VJgjVT+ZYv+AvLI9UdZoAHvwAA\\nVl/Q+/h9dR6dawOX+uqMEqkXYO/+GYPBu2U+hhSe1BCwHEAIxjNaEe9/H3HrIf9k\\nBDSc8mRk1MwOiu5BvKxISWdWbgAgZKzlQaD9/knH430b9YtmF/jseoa1oG+p3cpu\\nfCyFma7yabR9Quugnx8IqSAm4rxVrDfAgH3gRsjwx5QUsl9wVz/egF0XRS6ScR7t\\nvxjd1oUr9Jt1G3QyPk2zLAD+IgAHNah6Sp/Jrp6pgQKBgQDK5Rl6jNlxUQHHSk26\\nQPV4fUMA3aQeERNqRKvSIPNB7upTbdh1ZoU5UeIzIIP4vI4y/B7V+fMQDXjjXuv2\\nft/R6SQ2DgoA3LOH6c+H6c5M5EtPNe/CSkUeKOlIO7IEQVbMyeroV49hfbslHl9G\\nnXxzmmb6pv6lKZTSy75SLZPCgQKBgQDADkqg2Qg26zFxSC5aeiUTQSzyBbVZxwlU\\nnibZpzB9oeQTWuCiS5HWug4T35/YYmzmnQDsM+EQ+JyLdWY9js4Was4eeI/2BxDN\\nYH5TKRB0rIJZ8brUjhVPYSxnBBC+nH9fxlHCQtJA8agEeB6lwqFjy0d6Av+1TUMm\\nBe9j5upq2QKBgD398eL31hhBYAG8OjOGVXoTC73f+p0VKpF1meoCF1E15nLHRTPZ\\ntyrkUfC9JpWBRxFc5y8Jx7JH63/NKNuPuGMykNXTREsvI8uLLNWiIl5sAnaZTEBY\\n4PVuGpjvZFzYeeTobNXAqxZmjB+zP/kbdUL9EinTjEp6gfZGOkhxlIwBAoGATOhs\\nMiU3COb+EaMaDNlE54T9/p0SljUCI4SBgj9VR7oAn0+RDOy+JgKziHnQhNJFUcQl\\njnDn++fSqHYGzzfUh12V1NXqsFb7/4JYk+ypzk8Wk/YdHukW14bORSJ3oh0BVNUS\\nAHzJvYAIDGIdw7tA7bmFkfKJe4zJCvztdFAQJ2ECgYEAwmUMJ8lxdckV2RhxSs8G\\n1iG5f+lfU/e28EHDkV5w20ggaHiybaR/Ye72dLFLXhszMgaVWrP52Voc5aQ3oPaM\\nobJnbdft7IEcLpjLyM94jIN+gGhMvEaulLM3Do/odUvcGpQj8mSqcJqLA/j/j9a7\\n9dAIlJJsy5l3DfBFNn3fNFQ=\\n-----END PRIVATE KEY-----\\n"
    },
    {
        "id": "96087061.c7ebf",
        "type": "ui_tab",
        "name": "Garten",
        "icon": "dashboard",
        "order": 6,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d32aa509.f54168",
        "type": "ui_group",
        "name": "Licht",
        "tab": "96087061.c7ebf",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "eeb221fb.ab27f",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "test",
        "name": "InfluxDB",
        "usetls": true,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "1.8-flux",
        "url": "http://localhost:8086",
        "rejectUnauthorized": false
    },
    {
        "id": "d50d0c9f.31e858",
        "type": "tls-config",
        "name": "",
        "cert": "",
        "key": "",
        "ca": "",
        "certname": "",
        "keyname": "",
        "caname": "",
        "servername": "",
        "verifyservercert": false
    },
    {
        "id": "4218b917.19c388",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "test 1.8 flux",
        "usetls": false,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "1.8-flux",
        "url": "https://localhost:8086",
        "rejectUnauthorized": false
    },
    {
        "id": "34d9864c.b1c48a",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "",
        "usetls": false,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "2.0",
        "url": "https://localhost:9999",
        "rejectUnauthorized": false
    },
    {
        "id": "e8e347ff.a2d828",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "test 1.8 flux",
        "usetls": false,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "1.8-flux",
        "url": "https://localhost:8086",
        "rejectUnauthorized": false
    },
    {
        "id": "df38d77.6477828",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "test 1.8 flux",
        "usetls": false,
        "tls": "d50d0c9f.31e858",
        "influxdbVersion": "1.8-flux",
        "url": "https://localhost:8086",
        "rejectUnauthorized": false
    },
    {
        "id": "3947370c.304948",
        "type": "influxdb",
        "hostname": "192.168.202.177",
        "port": "8086",
        "protocol": "http",
        "database": "wl.adviser.com",
        "name": "",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "1.x"
    },
    {
        "id": "d63872c3.cf8dc",
        "type": "ui_group",
        "name": "Aktuell",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "957dd4b7.619928",
        "type": "ui_group",
        "name": "Verlauf",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "c824e9e5.f339c8",
        "type": "ui_tab",
        "name": "Treppenhaus",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "64b01bd0.e1d1b4",
        "type": "ui_group",
        "name": "Aktuell",
        "tab": "c824e9e5.f339c8",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "e8ee0bf9.1711f8",
        "type": "mqtt-broker",
        "z": "29cd7d28.a2bf92",
        "broker": "localhost",
        "port": "1883",
        "clientid": "node-red",
        "usetls": false,
        "verifyservercert": true,
        "compatmode": true,
        "keepalive": "15",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": ""
    },
    {
        "id": "6e72ca89.a4fc04",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": "6",
        "height": "2"
    },
    {
        "id": "da0dc882.b12038",
        "type": "ui_tab",
        "name": "Lüftungsempfehlungen",
        "icon": "dashboard",
        "order": 9,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "245ec0f9.12765",
        "type": "ui_group",
        "name": "Group 1",
        "tab": "da0dc882.b12038",
        "order": 1,
        "disp": false,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ec48ea8.9196518",
        "type": "ui_group",
        "name": "Heizung",
        "tab": "748155f1.44babc",
        "order": 7,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "c2e6322e.33404",
        "type": "fritz-api",
        "name": "fritzBox",
        "host": "http://fritz.box",
        "strictSSL": true
    },
    {
        "id": "748155f1.44babc",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a8a6836d.1b1cf",
        "type": "ui_group",
        "name": "Gas",
        "tab": "e822c4d8.ce3a88",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "e2d75124.92d37",
        "type": "ui_tab",
        "name": "Heizung",
        "icon": "dashboard",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "85193673.744e38",
        "type": "ui_group",
        "name": "Group 1",
        "tab": "e2d75124.92d37",
        "order": 1,
        "disp": false,
        "width": "6",
        "collapse": false
    },
    {
        "id": "dab59e38.c408e",
        "type": "ui_group",
        "name": "Strom",
        "tab": "e822c4d8.ce3a88",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "f01a88f1.841248",
        "type": "template",
        "z": "befdc0fb.ac3d3",
        "name": "Action toggle",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"action\": \"toggle\"}",
        "output": "json",
        "x": 330,
        "y": 120,
        "wires": [
            [
                "5f7ad033.88514"
            ]
        ]
    },
    {
        "id": "b6139de2.2f87d",
        "type": "template",
        "z": "befdc0fb.ac3d3",
        "name": "Action toggle",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"action\": \"toggle\"}",
        "output": "json",
        "x": 730,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "5f7ad033.88514",
        "type": "delay",
        "z": "befdc0fb.ac3d3",
        "name": "",
        "pauseType": "delay",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 550,
        "y": 120,
        "wires": [
            [
                "b6139de2.2f87d"
            ]
        ]
    },
    {
        "id": "664aeec7.e753d",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "arrow_right_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "arrow_left_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up_click",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down_click",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down_click",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "toggle",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "arrow_right_click",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "arrow_left_click",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 9,
        "x": 370,
        "y": 440,
        "wires": [
            [],
            [],
            [
                "49199ea5.7436c"
            ],
            [
                "f4dedcc1.6edff"
            ],
            [],
            [],
            [
                "5a9ba8dd.c08758"
            ],
            [
                "49199ea5.7436c"
            ],
            [
                "f4dedcc1.6edff"
            ]
        ]
    },
    {
        "id": "c7393d5d.d251",
        "type": "switch",
        "z": "74074f6d.94c6d",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "short",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "long",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 120,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "b878ef06.91fa7",
        "type": "json",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 230,
        "y": 440,
        "wires": [
            [
                "664aeec7.e753d"
            ]
        ]
    },
    {
        "id": "500b4e64.84283",
        "type": "change",
        "z": "74074f6d.94c6d",
        "name": "Process delta",
        "rules": [
            {
                "t": "set",
                "p": "threshold",
                "pt": "msg",
                "to": "400",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "delta",
                "pt": "msg",
                "to": "payload[1].timestamp - payload[0].timestamp",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "delta <= 5000 ? (delta < threshold ? 'short' : 'long') : undefined",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 120,
        "wires": [
            [
                "c7393d5d.d251"
            ]
        ]
    },
    {
        "id": "af3c9414.281838",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Fernbedienung WoZi",
        "topic": "zigbee2mqtt/fernbedienung_wozi",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 400,
        "wires": [
            [
                "b878ef06.91fa7"
            ]
        ]
    },
    {
        "id": "113b0178.6ed4ff",
        "type": "join",
        "z": "74074f6d.94c6d",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "payload.state",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "5",
        "count": "2",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 390,
        "y": 120,
        "wires": [
            [
                "500b4e64.84283"
            ]
        ]
    },
    {
        "id": "d15cd0de.e4d8a",
        "type": "change",
        "z": "74074f6d.94c6d",
        "name": "Add timestamp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{'state': payload, 'timestamp': $millis()}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 220,
        "y": 120,
        "wires": [
            [
                "113b0178.6ed4ff"
            ]
        ]
    },
    {
        "id": "930e92a7.3f378",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Wandtaster rechts",
        "topic": "wandschalter_wozi1/binary_sensor/rechts/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 260,
        "wires": [
            [
                "5bd1bdfd.b90a34"
            ]
        ]
    },
    {
        "id": "84c90245.9e44f",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Wandtaster links",
        "topic": "wandschalter_wozi1/binary_sensor/links/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 220,
        "wires": [
            [
                "c018a260.a19a4"
            ]
        ]
    },
    {
        "id": "fb43367b.7b8798",
        "type": "inject",
        "z": "2ba29887.9266e8",
        "name": "Reset",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 150,
        "y": 340,
        "wires": [
            [
                "a4d36104.6861a",
                "3821ccd0.2b46d4"
            ]
        ]
    },
    {
        "id": "a4d36104.6861a",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "initialize",
        "func": "flow.set(\"esszimmertisch\", {\"state\": \"off\"});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "3821ccd0.2b46d4",
        "type": "template",
        "z": "2ba29887.9266e8",
        "name": "action off",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"action\": \"off\"}",
        "output": "json",
        "x": 420,
        "y": 360,
        "wires": [
            [
                "65255bf4.4a4b34"
            ]
        ]
    },
    {
        "id": "65255bf4.4a4b34",
        "type": "link out",
        "z": "2ba29887.9266e8",
        "name": "initialize",
        "links": [],
        "x": 535,
        "y": 360,
        "wires": []
    },
    {
        "id": "24b7e9a9.dd1536",
        "type": "switch",
        "z": "2ba29887.9266e8",
        "name": "action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_move_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_move_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_stop",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 390,
        "y": 620,
        "wires": [
            [
                "fbd3fa30.5c21a8"
            ],
            [
                "8292a950.919fc8"
            ],
            [
                "a28d578f.9e08b8"
            ],
            [
                "2efa936c.7096bc"
            ],
            [
                "778e41ee.f0eb4"
            ]
        ]
    },
    {
        "id": "290b868d.4fa33a",
        "type": "mqtt in",
        "z": "2ba29887.9266e8",
        "name": "Fernbedienung Esszimmer",
        "topic": "zigbee2mqtt/fernbedienung_esszimmer",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 580,
        "wires": [
            [
                "24b7e9a9.dd1536"
            ]
        ]
    },
    {
        "id": "8292a950.919fc8",
        "type": "template",
        "z": "2ba29887.9266e8",
        "name": "State OFF",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"OFF\"}",
        "output": "json",
        "x": 610,
        "y": 600,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "fbd3fa30.5c21a8",
        "type": "template",
        "z": "2ba29887.9266e8",
        "name": "State ON_",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"ON\"}",
        "output": "json",
        "x": 610,
        "y": 560,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "13b7ccd6.d98e83",
        "type": "mqtt out",
        "z": "2ba29887.9266e8",
        "name": "Esszimmertisch",
        "topic": "zigbee2mqtt/esszimmertisch/set",
        "qos": "1",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 980,
        "y": 560,
        "wires": []
    },
    {
        "id": "de92566e.0d9718",
        "type": "mqtt in",
        "z": "2ba29887.9266e8",
        "name": "Esszimmertisch",
        "topic": "zigbee2mqtt/esszimmertisch",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1160,
        "y": 560,
        "wires": [
            [
                "c4938613.a86088",
                "811e8564.045d88"
            ]
        ]
    },
    {
        "id": "c4938613.a86088",
        "type": "json",
        "z": "2ba29887.9266e8",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1310,
        "y": 560,
        "wires": [
            [
                "6d9790ef.bf03b",
                "af26ea70.e86bc8",
                "4db81f06.f5ed8"
            ]
        ]
    },
    {
        "id": "6d9790ef.bf03b",
        "type": "change",
        "z": "2ba29887.9266e8",
        "name": "save Esszimmertisch state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "esszimmertisch",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 600,
        "wires": [
            [
                "e1bc8179.cec62"
            ]
        ]
    },
    {
        "id": "e2cb5e97.bb6e8",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "increment esszimmertisch brightness",
        "func": "var leuchter = flow.get(\"esszimmertisch\")\n\nleuchter[\"brightness\"] += 5;\nif (leuchter[\"brightness\"] > 100) {\n    leuchter[\"brightness\"] = 100;\n}\n\nflow.set(\"esszimmertisch\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 830,
        "y": 640,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "f0e908ff.7a1918",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "decrement esszimmertisch brightness",
        "func": "var leuchter = flow.get(\"esszimmertisch\")\n\nleuchter[\"brightness\"] -= 5;\nif (leuchter[\"brightness\"] < 10) {\n    leuchter[\"brightness\"] = 20;\n}\nflow.set(\"esszimmertisch\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 830,
        "y": 680,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "e1bc8179.cec62",
        "type": "debug",
        "z": "2ba29887.9266e8",
        "name": "Esszimmertisch",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1300,
        "y": 640,
        "wires": []
    },
    {
        "id": "a28d578f.9e08b8",
        "type": "looptimer",
        "z": "2ba29887.9266e8",
        "duration": "0.25",
        "units": "Second",
        "maxloops": "20",
        "maxtimeout": "10",
        "maxtimeoutunits": "Second",
        "name": "Dim",
        "x": 590,
        "y": 640,
        "wires": [
            [
                "e2cb5e97.bb6e8"
            ],
            []
        ]
    },
    {
        "id": "2efa936c.7096bc",
        "type": "looptimer",
        "z": "2ba29887.9266e8",
        "duration": "0.25",
        "units": "Second",
        "maxloops": "20",
        "maxtimeout": "10",
        "maxtimeoutunits": "Second",
        "name": "Dim",
        "x": 590,
        "y": 680,
        "wires": [
            [
                "f0e908ff.7a1918"
            ],
            []
        ]
    },
    {
        "id": "778e41ee.f0eb4",
        "type": "template",
        "z": "2ba29887.9266e8",
        "name": "STOP",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "STOP",
        "output": "str",
        "x": 410,
        "y": 680,
        "wires": [
            [
                "a28d578f.9e08b8",
                "2efa936c.7096bc"
            ]
        ]
    },
    {
        "id": "e67f8756.0aced8",
        "type": "link in",
        "z": "2ba29887.9266e8",
        "name": "",
        "links": [],
        "x": 275,
        "y": 660,
        "wires": [
            [
                "24b7e9a9.dd1536"
            ]
        ]
    },
    {
        "id": "4db81f06.f5ed8",
        "type": "mqtt out",
        "z": "2ba29887.9266e8",
        "name": "Esszimmer Eckschrank",
        "topic": "zigbee2mqtt/esszimmer_eckschrank/set",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1010,
        "y": 860,
        "wires": []
    },
    {
        "id": "5b18f2d2.31ab8c",
        "type": "mqtt in",
        "z": "2ba29887.9266e8",
        "name": "Esszimmer Eckschrank",
        "topic": "zigbee2mqtt/esszimmer_eckschrank",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1240,
        "y": 860,
        "wires": [
            [
                "2aacd971.071d76"
            ]
        ]
    },
    {
        "id": "2aacd971.071d76",
        "type": "json",
        "z": "2ba29887.9266e8",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1410,
        "y": 860,
        "wires": [
            [
                "ca4c1378.25b3f",
                "ddf229af.5ef508"
            ]
        ]
    },
    {
        "id": "ca4c1378.25b3f",
        "type": "change",
        "z": "2ba29887.9266e8",
        "name": "save Esszimmer Eckschrank state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "Esszimmer_eckschrank",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 900,
        "wires": [
            [
                "c0204c41.c1cbb"
            ]
        ]
    },
    {
        "id": "c0204c41.c1cbb",
        "type": "debug",
        "z": "2ba29887.9266e8",
        "name": "Esszimmer Eckschrank",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1390,
        "y": 940,
        "wires": []
    },
    {
        "id": "ddf229af.5ef508",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1010,
        "y": 940,
        "wires": [
            [
                "cc2ba7a4.276d78"
            ]
        ]
    },
    {
        "id": "cc2ba7a4.276d78",
        "type": "ui_switch",
        "z": "2ba29887.9266e8",
        "name": "An/Aus Esszimmer Eckschrank",
        "label": "An/Aus",
        "tooltip": "",
        "group": "643154e.6b44bac",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "x": 1090,
        "y": 980,
        "wires": [
            [
                "4db81f06.f5ed8"
            ]
        ]
    },
    {
        "id": "af26ea70.e86bc8",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1090,
        "y": 660,
        "wires": [
            [
                "efbb8637.d28188"
            ]
        ]
    },
    {
        "id": "efbb8637.d28188",
        "type": "ui_switch",
        "z": "2ba29887.9266e8",
        "name": "An/Aus Esszimmer Tisch",
        "label": "An/Aus",
        "tooltip": "",
        "group": "12ecf9a1.9cb126",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "x": 1150,
        "y": 700,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "811e8564.045d88",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "brightness",
        "func": "msg.payload = msg.payload.brightness;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1110,
        "y": 740,
        "wires": [
            [
                "b95edb0e.4e93d8"
            ]
        ]
    },
    {
        "id": "b95edb0e.4e93d8",
        "type": "ui_slider",
        "z": "2ba29887.9266e8",
        "name": "Helligkeit Esszimmer Tisch Fernsehzimmer",
        "label": "Helligkeit",
        "tooltip": "",
        "group": "12ecf9a1.9cb126",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "all",
        "topic": "",
        "min": "10",
        "max": "100",
        "step": "10",
        "x": 1210,
        "y": 780,
        "wires": [
            [
                "6f2d06af.6b5c88"
            ]
        ]
    },
    {
        "id": "6f2d06af.6b5c88",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "brightness",
        "func": "msg.payload = {\"brightness\": msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1470,
        "y": 780,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "c631ec2b.95c1d",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "initialize Scenes",
        "func": "flow.set(\"current_scene_idx\", 0)\nflow.set(\"max_scene_idx\", 4)\nflow.set(\"scenes\", [\n        {   scene_idx: 0,\n            scene_name: \"aus\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tiffany\",\n                    state: \"off\"\n                },\n                {   device_idx: 2,\n                    name: \"Fensterbank\",\n                    state: \"off\"\n                },\n                {   device_idx: 3,\n                    name: \"Klavierlampe\",\n                    state: \"off\"\n                },\n                {   device_idx: 4,\n                    name: \"Leuchter\",\n                    state: \"off\"\n                }\n            ]\n        },\n        {   scene_idx: 1,\n            scene_name: \"ambiente\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tiffany\",\n                    brightness: 70,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Fensterbank\",\n                    brightness: 70,\n                    state: \"on\"\n                },\n                {   device_idx: 3,\n                    name: \"Klavierlampe\",\n                    state: \"on\"\n                },\n                {   device_idx: 4,\n                    name: \"Leuchter\",\n                    state: \"off\"\n                }\n            ]\n        },\n          {   scene_idx: 2,\n            scene_name: \"cosy\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tiffany\",\n                    brightness: 100,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Fensterbank\",\n                    brightness: 100,\n                    state: \"on\"\n                },\n                {   device_idx: 3,\n                    name: \"Klavierlampe\",\n                    state: \"on\"\n                },\n                {   device_idx: 4,\n                    name: \"Leuchter\",\n                    state: \"off\"\n                }\n            ]\n        },\n        {   scene_idx: 3,\n            scene_name: \"sofa_read\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tiffany\",\n                    brightness: 100,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Fensterbank\",\n                    brightness: 255,\n                    state: \"on\"\n                },\n                {   device_idx: 3,\n                    name: \"Klavierlampe\",\n                    state: \"on\"\n                },\n                {   device_idx: 4,\n                    name: \"Leuchter\",\n                    state: \"off\"\n                }\n            ]\n        },\n      {   scene_idx: 4,\n            scene_name: \"bright\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tiffany\",\n                    brightness: 100,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Fensterbank\",\n                    brightness: 255,\n                    state: \"on\"\n                },\n                {   device_idx: 3,\n                    name: \"Klavierlampe\",\n                    state: \"on\"\n                },\n                {   device_idx: 4,\n                    name: \"Leuchter\",\n                    brightness: 100,\n                    state: \"on\"\n                }\n            ]\n        }\n    ]\n)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "dd76d72f.e06798",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload.device_idx",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "4",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 1130,
        "y": 540,
        "wires": [
            [],
            [
                "3a3f3f29.1be49"
            ],
            [
                "bd4f1b1d.c1d598"
            ],
            [
                "773f6fe1.26d11"
            ],
            [
                "d0971035.fd6cc"
            ]
        ]
    },
    {
        "id": "49199ea5.7436c",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "next scene",
        "func": "var current_scene_idx = flow.get(\"current_scene_idx\");\nvar max_scene_idx = flow.get(\"max_scene_idx\");\n\ncurrent_scene_idx++\nif (current_scene_idx > max_scene_idx) {\n    current_scene_idx = 0\n}\n\nmsg.payload = current_scene_idx;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 440,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "f4dedcc1.6edff",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "previous scene",
        "func": "var current_scene_idx = flow.get(\"current_scene_idx\");\nvar max_scene_idx = flow.get(\"max_scene_idx\");\n\ncurrent_scene_idx--\nif (current_scene_idx < 0 ) {\n    current_scene_idx = max_scene_idx\n}\n\nflow.set(\"current_scene_idx\", current_scene_idx);\n\nmsg.payload = current_scene_idx;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 480,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "ed1e9ea1.c5e59",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "save scene idx",
        "func": "msg.payload = Number(msg.payload)\nflow.set(\"current_scene_idx\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 940,
        "y": 460,
        "wires": [
            [
                "62b32ef7.840d6",
                "a7dbd651.4467b8"
            ]
        ]
    },
    {
        "id": "62b32ef7.840d6",
        "type": "debug",
        "z": "37daec28.284ee4",
        "name": "current scene idx",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 460,
        "wires": []
    },
    {
        "id": "a7dbd651.4467b8",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "current scene",
        "func": "var scenes = flow.get(\"scenes\");\nvar current_scene_idx = flow.get(\"current_scene_idx\");\nvar scene = scenes[current_scene_idx];\nmsg.payload = scene.devices;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 940,
        "y": 500,
        "wires": [
            [
                "9cfaf9a.449b908"
            ]
        ]
    },
    {
        "id": "9cfaf9a.449b908",
        "type": "split",
        "z": "37daec28.284ee4",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 910,
        "y": 540,
        "wires": [
            [
                "dd76d72f.e06798"
            ]
        ]
    },
    {
        "id": "3a3f3f29.1be49",
        "type": "link out",
        "z": "37daec28.284ee4",
        "name": "",
        "links": [
            "5b5a2542.cb90bc",
            "a14232cb.a4256",
            "e30a134d.f410a",
            "6637cc7f.54ff74"
        ],
        "x": 1315,
        "y": 500,
        "wires": []
    },
    {
        "id": "bd4f1b1d.c1d598",
        "type": "link out",
        "z": "37daec28.284ee4",
        "name": "",
        "links": [
            "a14232cb.a4256",
            "e30a134d.f410a"
        ],
        "x": 1315,
        "y": 540,
        "wires": []
    },
    {
        "id": "773f6fe1.26d11",
        "type": "link out",
        "z": "37daec28.284ee4",
        "name": "",
        "links": [
            "bc7fb10d.fa659",
            "4bbc2b23.ee06a4"
        ],
        "x": 1315,
        "y": 580,
        "wires": []
    },
    {
        "id": "d0971035.fd6cc",
        "type": "link out",
        "z": "37daec28.284ee4",
        "name": "",
        "links": [
            "cd111146.3d5c4",
            "e5d97c3.d1d738"
        ],
        "x": 1315,
        "y": 620,
        "wires": []
    },
    {
        "id": "c5a30ac4.50aad8",
        "type": "inject",
        "z": "37daec28.284ee4",
        "name": "Reset",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 170,
        "y": 140,
        "wires": [
            [
                "c631ec2b.95c1d"
            ]
        ]
    },
    {
        "id": "4d73c0b1.422e1",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "2",
        "func": "msg.payload = 2;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 220,
        "wires": [
            [
                "5e79d51e.9213dc"
            ]
        ]
    },
    {
        "id": "79fb43e2.dda08c",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "4",
        "func": "msg.payload = 4;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 260,
        "wires": [
            [
                "5e79d51e.9213dc"
            ]
        ]
    },
    {
        "id": "5e79d51e.9213dc",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "toggle szene",
        "func": "var new_scene_idx = msg.payload;\nvar current_scene_idx = flow.get(\"current_scene_idx\");\n\nif (current_scene_idx != new_scene_idx) {\n    current_scene_idx = new_scene_idx\n} else {\n    current_scene_idx = 0\n}\n\nmsg.payload = current_scene_idx;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 730,
        "y": 240,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "dde36893.70da28",
        "type": "ui_button",
        "z": "37daec28.284ee4",
        "name": "",
        "group": "3f0994e3.62d76c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Gemütlich",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "2",
        "payloadType": "num",
        "topic": "",
        "x": 550,
        "y": 640,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "af71545a.27def8",
        "type": "ui_button",
        "z": "37daec28.284ee4",
        "name": "",
        "group": "3f0994e3.62d76c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Sofa Lesen",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "3",
        "payloadType": "num",
        "topic": "",
        "x": 550,
        "y": 680,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "2653a92.9545856",
        "type": "ui_button",
        "z": "37daec28.284ee4",
        "name": "",
        "group": "3f0994e3.62d76c",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Hell",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "4",
        "payloadType": "num",
        "topic": "",
        "x": 530,
        "y": 720,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "e686622f.fbb93",
        "type": "ui_button",
        "z": "37daec28.284ee4",
        "name": "",
        "group": "3f0994e3.62d76c",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Aus",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 530,
        "y": 560,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "53bad8f.3633628",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "initialize scenes",
        "func": "flow.set(\"current_scene_idx\", 0)\nflow.set(\"max_scene_idx\", 3)\nflow.set(\"scenes\", [\n        {   scene_idx: 0,\n            scene_name: \"aus\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tisch\",\n                    state: \"off\"\n                },\n                {   device_idx: 2,\n                    name: \"Eckschrank\",\n                    state: \"off\"\n                }\n            ]\n        },\n        {   scene_idx: 1,\n            scene_name: \"Hell\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tisch\",\n                    brightness: 100,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Eckschrank\",\n                    state: \"on\"\n                }\n            ]\n        },\n        {   scene_idx: 2,\n            scene_name: \"Gemütlich\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tisch\",\n                    brightness: 50,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Eckschrank\",\n                    state: \"on\"\n                }\n            ]\n        },\n        {   scene_idx: 3,\n            scene_name: \"Ambiente\",\n            devices: [\n                {   device_idx: 1,\n                    name: \"Tisch\",\n                    brightness: 10,\n                    state: \"on\"\n                },\n                {   device_idx: 2,\n                    name: \"Eckschrank\",\n                    state: \"on\"\n                }\n            ]\n        }\n    ]\n)\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "8e92a889.216c18",
        "type": "switch",
        "z": "2ba29887.9266e8",
        "name": "",
        "property": "payload.device_idx",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 930,
        "y": 1200,
        "wires": [
            [],
            [
                "cd344841.b0ef18"
            ],
            [
                "abb09b26.4d8768"
            ]
        ]
    },
    {
        "id": "734500d1.9d61f",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "save scene idx",
        "func": "msg.payload = Number(msg.payload)\nflow.set(\"current_scene_idx\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 1120,
        "wires": [
            [
                "14c16485.af1efb",
                "19f37cfd.d46353"
            ]
        ]
    },
    {
        "id": "14c16485.af1efb",
        "type": "debug",
        "z": "2ba29887.9266e8",
        "name": "current scene idx",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 1120,
        "wires": []
    },
    {
        "id": "19f37cfd.d46353",
        "type": "function",
        "z": "2ba29887.9266e8",
        "name": "current scene",
        "func": "var scenes = flow.get(\"scenes\");\nvar current_scene_idx = flow.get(\"current_scene_idx\");\nvar scene = scenes[current_scene_idx];\nmsg.payload = scene.devices;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 1160,
        "wires": [
            [
                "f47853f2.a021d"
            ]
        ]
    },
    {
        "id": "f47853f2.a021d",
        "type": "split",
        "z": "2ba29887.9266e8",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 710,
        "y": 1200,
        "wires": [
            [
                "8e92a889.216c18",
                "4c223ece.64593"
            ]
        ]
    },
    {
        "id": "cd344841.b0ef18",
        "type": "link out",
        "z": "2ba29887.9266e8",
        "name": "",
        "links": [
            "91766e4a.6c0a7"
        ],
        "x": 1115,
        "y": 1180,
        "wires": []
    },
    {
        "id": "abb09b26.4d8768",
        "type": "link out",
        "z": "2ba29887.9266e8",
        "name": "",
        "links": [
            "b42c6c0f.4b835"
        ],
        "x": 1115,
        "y": 1220,
        "wires": []
    },
    {
        "id": "731caccd.2f8924",
        "type": "inject",
        "z": "2ba29887.9266e8",
        "name": "Reset",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 150,
        "y": 1020,
        "wires": [
            [
                "53bad8f.3633628"
            ]
        ]
    },
    {
        "id": "2202e11f.f782ee",
        "type": "ui_button",
        "z": "2ba29887.9266e8",
        "name": "",
        "group": "aca2d944.6c15c8",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Hell",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "",
        "x": 130,
        "y": 1120,
        "wires": [
            [
                "734500d1.9d61f"
            ]
        ]
    },
    {
        "id": "f5b99d67.4869b",
        "type": "ui_button",
        "z": "2ba29887.9266e8",
        "name": "",
        "group": "aca2d944.6c15c8",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Gemütlich",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "2",
        "payloadType": "num",
        "topic": "",
        "x": 150,
        "y": 1160,
        "wires": [
            [
                "734500d1.9d61f"
            ]
        ]
    },
    {
        "id": "747c9148.1a912",
        "type": "ui_button",
        "z": "2ba29887.9266e8",
        "name": "",
        "group": "aca2d944.6c15c8",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Ambiente",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "3",
        "payloadType": "num",
        "topic": "",
        "x": 140,
        "y": 1200,
        "wires": [
            [
                "734500d1.9d61f"
            ]
        ]
    },
    {
        "id": "a0a37e43.2bc1b",
        "type": "ui_button",
        "z": "2ba29887.9266e8",
        "name": "",
        "group": "aca2d944.6c15c8",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Aus",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 130,
        "y": 1080,
        "wires": [
            [
                "734500d1.9d61f"
            ]
        ]
    },
    {
        "id": "b42c6c0f.4b835",
        "type": "link in",
        "z": "2ba29887.9266e8",
        "name": "Eckschrank",
        "links": [
            "abb09b26.4d8768"
        ],
        "x": 815,
        "y": 860,
        "wires": [
            [
                "4db81f06.f5ed8"
            ]
        ]
    },
    {
        "id": "91766e4a.6c0a7",
        "type": "link in",
        "z": "2ba29887.9266e8",
        "name": "Esszimmertisch",
        "links": [
            "cd344841.b0ef18"
        ],
        "x": 795,
        "y": 520,
        "wires": [
            [
                "13b7ccd6.d98e83"
            ]
        ]
    },
    {
        "id": "4c223ece.64593",
        "type": "debug",
        "z": "2ba29887.9266e8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 960,
        "y": 1340,
        "wires": []
    },
    {
        "id": "90f805c3.80d1a8",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Leuchter",
        "links": [
            "dc035d1d.61da2",
            "2dad66e6.a64d7a",
            "45a22aec.0fb0a4",
            "a8224012.cff9a"
        ],
        "x": 335,
        "y": 2000,
        "wires": [
            [
                "da091852.405428"
            ]
        ]
    },
    {
        "id": "6bade79f.9d5208",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "State OFF",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"OFF\"}",
        "output": "json",
        "x": 630,
        "y": 1600,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "26b6dd5c.bad522",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "State ON",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"ON\"}",
        "output": "json",
        "x": 620,
        "y": 1560,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "5d0fee20.ccd4d",
        "type": "mqtt out",
        "z": "37daec28.284ee4",
        "name": "Klavierlampe",
        "topic": "zigbee2mqtt/klavierlampe/set",
        "qos": "1",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 990,
        "y": 1560,
        "wires": []
    },
    {
        "id": "f0382b17.121318",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Klavierlampe",
        "topic": "zigbee2mqtt/klavierlampe",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1170,
        "y": 1560,
        "wires": [
            [
                "2a4ae50f.d0a24a"
            ]
        ]
    },
    {
        "id": "2a4ae50f.d0a24a",
        "type": "json",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1310,
        "y": 1560,
        "wires": [
            [
                "c47da63c.598c78",
                "7eb17679.660788"
            ]
        ]
    },
    {
        "id": "c47da63c.598c78",
        "type": "change",
        "z": "37daec28.284ee4",
        "name": "save Klavierlampe state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "klavierlampe",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 1600,
        "wires": [
            [
                "31d2f239.bb705e"
            ]
        ]
    },
    {
        "id": "49eff550.6792ac",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Klavierleuchte",
        "links": [
            "ae219441.569ab8",
            "f715e53b.72b9f8",
            "7bc1764c.60caf8",
            "6c132f14.90408",
            "6b660054.35552",
            "bf127571.8796f8"
        ],
        "x": 335,
        "y": 1660,
        "wires": [
            [
                "36288578.3ef92a"
            ]
        ]
    },
    {
        "id": "36288578.3ef92a",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "Action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_max",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_min",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 430,
        "y": 1660,
        "wires": [
            [
                "26b6dd5c.bad522"
            ],
            [
                "6bade79f.9d5208"
            ],
            [],
            [],
            [
                "dad47b4a.4b94b8"
            ],
            [
                "f7703e37.21fc4"
            ]
        ],
        "outputLabels": [
            "brightness_up_click",
            "brightness_down_click",
            "",
            "",
            "",
            ""
        ]
    },
    {
        "id": "dad47b4a.4b94b8",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 254",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 254}",
        "output": "json",
        "x": 640,
        "y": 1720,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "f7703e37.21fc4",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 1",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 1}",
        "output": "json",
        "x": 630,
        "y": 1760,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "31d2f239.bb705e",
        "type": "debug",
        "z": "37daec28.284ee4",
        "name": "Klavierleuchte",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1320,
        "y": 1640,
        "wires": []
    },
    {
        "id": "7eb17679.660788",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 1640,
        "wires": [
            [
                "a491d10d.02174"
            ]
        ]
    },
    {
        "id": "a491d10d.02174",
        "type": "ui_switch",
        "z": "37daec28.284ee4",
        "name": "An/Aus Klavierlampe Fernsehzimmer",
        "label": "An/Aus",
        "tooltip": "",
        "group": "33913a78.8716a6",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "x": 1070,
        "y": 1680,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "4bbc2b23.ee06a4",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Set Klavierlampe",
        "links": [
            "7d2f7d57.122c54",
            "773f6fe1.26d11",
            "8bc43dda.f5f76"
        ],
        "x": 875,
        "y": 1520,
        "wires": [
            [
                "5d0fee20.ccd4d"
            ]
        ]
    },
    {
        "id": "e5d97c3.d1d738",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Set Leuchter",
        "links": [
            "4b03e0d9.5ac29",
            "d0971035.fd6cc",
            "9e89c97e.5c7568"
        ],
        "x": 875,
        "y": 1860,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "e30a134d.f410a",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Set Fensterbank",
        "links": [
            "54c14fb0.1f53d",
            "8c16d699.6098e8",
            "3a3f3f29.1be49",
            "bd4f1b1d.c1d598"
        ],
        "x": 855,
        "y": 1180,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "6637cc7f.54ff74",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Set Tiffany",
        "links": [
            "17daaa56.bbd986",
            "54c14fb0.1f53d",
            "3a3f3f29.1be49"
        ],
        "x": 855,
        "y": 840,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "47116ef.607c79",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Tiffany",
        "links": [
            "15e380ee.a0db0f",
            "328112f4.3a1a5e",
            "ae219441.569ab8",
            "33579b3d.255244",
            "6c132f14.90408",
            "6b660054.35552",
            "88abccef.24a7d"
        ],
        "x": 335,
        "y": 980,
        "wires": [
            [
                "b9e6bfe3.96c8f"
            ]
        ]
    },
    {
        "id": "c5aa4ded.daf6d",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state ON_",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"ON\"}",
        "output": "json",
        "x": 620,
        "y": 1220,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "3915a3f2.641aac",
        "type": "mqtt out",
        "z": "37daec28.284ee4",
        "name": "Fensterbank",
        "topic": "zigbee2mqtt/fensterbank/set",
        "qos": "1",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 990,
        "y": 1220,
        "wires": []
    },
    {
        "id": "f53bfe8.c90b9",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Fensterbank",
        "topic": "zigbee2mqtt/fensterbank",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1170,
        "y": 1220,
        "wires": [
            [
                "43528aea.e5c924"
            ]
        ]
    },
    {
        "id": "43528aea.e5c924",
        "type": "json",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1310,
        "y": 1220,
        "wires": [
            [
                "63507385.c44d5c",
                "bcc690db.8cb87",
                "b07f212d.4c75a"
            ]
        ]
    },
    {
        "id": "e291675d.3e5718",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state OFF",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"OFF\"}",
        "output": "json",
        "x": 620,
        "y": 1260,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "63507385.c44d5c",
        "type": "change",
        "z": "37daec28.284ee4",
        "name": "save fensterbank state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "fensterbank",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1260,
        "wires": [
            [
                "7da55143.813f7"
            ]
        ]
    },
    {
        "id": "f36ca8e5.688cd8",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "increment fensterbank brightness",
        "func": "var leuchter = flow.get(\"fensterbank\")\n\nleuchter[\"brightness\"] += 25;\nif (leuchter[\"brightness\"] > 254) {\n    leuchter[\"brightness\"] = 254;\n}\n\nflow.set(\"fensterbank\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 700,
        "y": 1300,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "f5f8a4cb.927668",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "decrement fensterbank brightness",
        "func": "var leuchter = flow.get(\"fensterbank\")\n\nleuchter[\"brightness\"] -= 10;\nif (leuchter[\"brightness\"] < 0) {\n    leuchter[\"brightness\"] = 0;\n}\nflow.set(\"fensterbank\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 700,
        "y": 1340,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "7599c6e6.a5f9a8",
        "type": "link in",
        "z": "37daec28.284ee4",
        "name": "Fensterbank",
        "links": [
            "15e380ee.a0db0f",
            "bc229fc5.4db36",
            "ae219441.569ab8",
            "d6baef0f.243df",
            "6c132f14.90408",
            "6b660054.35552",
            "8f1aeeda.1f8c5"
        ],
        "x": 335,
        "y": 1320,
        "wires": [
            [
                "f9c8e4f3.59c4f8"
            ]
        ]
    },
    {
        "id": "f9c8e4f3.59c4f8",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "Action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_max",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_min",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 430,
        "y": 1320,
        "wires": [
            [
                "c5aa4ded.daf6d"
            ],
            [
                "e291675d.3e5718"
            ],
            [
                "f36ca8e5.688cd8"
            ],
            [
                "f5f8a4cb.927668"
            ],
            [
                "15e7f734.573e69"
            ],
            [
                "c93dba4a.5c8178"
            ]
        ],
        "outputLabels": [
            "brightness_up_click",
            "brightness_down_click",
            "",
            "",
            "",
            ""
        ]
    },
    {
        "id": "15e7f734.573e69",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 254",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 254}",
        "output": "json",
        "x": 640,
        "y": 1380,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "c93dba4a.5c8178",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 1",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 1}",
        "output": "json",
        "x": 630,
        "y": 1420,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "7da55143.813f7",
        "type": "debug",
        "z": "37daec28.284ee4",
        "name": "Fensterbank",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1390,
        "y": 1300,
        "wires": []
    },
    {
        "id": "8e0a2075.97183",
        "type": "ui_switch",
        "z": "37daec28.284ee4",
        "name": "An/Aus Fensterbank Fernsehzimmer",
        "label": "An/Aus",
        "tooltip": "",
        "group": "740db3e2.8916ac",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "x": 1070,
        "y": 1320,
        "wires": [
            [
                "7da55143.813f7",
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "4ba59f70.c989c",
        "type": "ui_slider",
        "z": "37daec28.284ee4",
        "name": "Helligkeit Fensterbank Fernsehzimmer",
        "label": "Helligkeit",
        "tooltip": "",
        "group": "740db3e2.8916ac",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "all",
        "topic": "",
        "min": "20",
        "max": "254",
        "step": "25",
        "x": 1070,
        "y": 1400,
        "wires": [
            [
                "9ac7d8bf.354318"
            ]
        ]
    },
    {
        "id": "9ac7d8bf.354318",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = {\"brightness\": msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 1400,
        "wires": [
            [
                "3915a3f2.641aac"
            ]
        ]
    },
    {
        "id": "bcc690db.8cb87",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 1280,
        "wires": [
            [
                "8e0a2075.97183"
            ]
        ]
    },
    {
        "id": "b07f212d.4c75a",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = msg.payload.brightness;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 1360,
        "wires": [
            [
                "4ba59f70.c989c"
            ]
        ]
    },
    {
        "id": "5455332d.7b9c3c",
        "type": "ui_button",
        "z": "37daec28.284ee4",
        "name": "",
        "group": "3f0994e3.62d76c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Ambiente",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "",
        "x": 540,
        "y": 600,
        "wires": [
            [
                "ed1e9ea1.c5e59"
            ]
        ]
    },
    {
        "id": "267d2e1.40785d2",
        "type": "function",
        "z": "2f328ad8.26ca86",
        "name": "Create Message",
        "func": "var send_rate = Number(msg.payload.NewByteSendRate)\nvar receive_rate = Number(msg.payload.NewByteReceiveRate)\n\nmsg = [\n    {payload: receive_rate / 1024 / 1024 * 8},\n    {payload: send_rate / 1024 / 1024 * 8}\n];\n\nreturn msg;",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 80,
        "wires": [
            [
                "678631ab.fe1bb"
            ],
            [
                "9d0190fe.0d3fe"
            ]
        ]
    },
    {
        "id": "a29449a0.411b18",
        "type": "inject",
        "z": "2f328ad8.26ca86",
        "name": "Every 5s",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 80,
        "wires": [
            [
                "3e907215.115b5e"
            ]
        ]
    },
    {
        "id": "3e907215.115b5e",
        "type": "fritzbox-in",
        "z": "2f328ad8.26ca86",
        "device": "48b52eb1.50063",
        "name": "",
        "service": "urn:schemas-upnp-org:service:WANCommonInterfaceConfig:1",
        "action": "GetAddonInfos",
        "arguments": "{}",
        "x": 410,
        "y": 80,
        "wires": [
            [
                "267d2e1.40785d2"
            ]
        ]
    },
    {
        "id": "c7d0f042.da84c",
        "type": "hangoutChatBot",
        "z": "29cd7d28.a2bf92",
        "hangoutsCertificate": "10925253.f46f4e",
        "roomid": "spaces/-fp3jQAAAAE",
        "roomname": "spaces/-fp3jQAAAAE",
        "contentproperty": "Hallo",
        "contenttype": "str",
        "x": 410,
        "y": 160,
        "wires": [
            [
                "b9ab9ed.d50006"
            ]
        ]
    },
    {
        "id": "4d466cfb.f9e804",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 160,
        "wires": [
            [
                "c7d0f042.da84c"
            ]
        ]
    },
    {
        "id": "b9ab9ed.d50006",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 160,
        "wires": []
    },
    {
        "id": "c018a260.a19a4",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "state ON",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "ON",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 400,
        "y": 220,
        "wires": [
            [
                "4d73c0b1.422e1"
            ]
        ]
    },
    {
        "id": "5bd1bdfd.b90a34",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "state ON",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "ON",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 400,
        "y": 260,
        "wires": [
            [
                "79fb43e2.dda08c"
            ]
        ]
    },
    {
        "id": "2f8c3777.ecafb8",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "waschkueche_luefter/sensor/humidity/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 230,
        "y": 180,
        "wires": [
            [
                "b56cd25f.124c9",
                "f24eda7c.102788",
                "ea8ce2c6.69dcd"
            ]
        ]
    },
    {
        "id": "a8931b52.026628",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "fan controller",
        "func": "const mw = 18.01534;    // molar mass of water g/mol\nconst r = 8.31447215;   // Universal gas constant J/mol/K\n\nconst outside_abs_humidity = global.get(\"aussen-absolute_humidity\");\nconst wk_temperature = global.get(\"waschkueche_luefter-temperature\");\nconst wk_humidity = global.get(\"waschkueche_luefter-humidity\");\nconst wk_abs_humidity = global.get(\"waschkueche_luefter-absolute_humidity\");\n\nconst washroom_fan_control = flow.get(\"washroom_fan_control\");\nconst last_abs_humidity_gt_outside_abs_humidity = global.get(\"washroom-last_abs_humidity_gt_outside_abs_humidity\");\n\nconst room_abs_humidity_gt_outside_abs_humidity = (last_abs_humidity_gt_outside_abs_humidity) ?\n    wk_abs_humidity > outside_abs_humidity * 1.05:\n    wk_abs_humidity > outside_abs_humidity;\n\nglobal.set(\"washroom-last_abs_humidity_gt_outside_abs_humidity\", wk_abs_humidity > outside_abs_humidity);\n\nvar washroom_fan_on;\nif (washroom_fan_control == \"ON\") {\n    if (room_abs_humidity_gt_outside_abs_humidity) {\n        if (wk_humidity > 65 || wk_temperature > 17) {\n            washroom_fan_on = \"ON\";\n        } else {\n            washroom_fan_on = \"OFF\";\n        }\n    } else {\n        washroom_fan_on = \"OFF\"\n    }\n}\n\nif (false) {\n    node.warn(\"outside_abs_humidity \" + outside_abs_humidity);   \n    node.warn(\"wk_temperature) \" + wk_temperature);   \n    node.warn(\"wk_humidity \" + wk_humidity);   \n    node.warn(\"wk_abs_humidity \" + wk_abs_humidity);   \n    node.warn(\"washroom_fan_on \" + washroom_fan_on);   \n    node.warn(\"washroom_fan_control \" + washroom_fan_control);   \n    node.warn(\"last_abs_humidity_gt_outside_abs_humidity \" + last_abs_humidity_gt_outside_abs_humidity);   \n}\n\n\nmsg = [\n    {topic: \"Waschküche g/m³\", payload: wk_abs_humidity},\n    {topic: \"Außen g/m³\", payload: outside_abs_humidity},\n    (washroom_fan_on) ? {topic: \"luefter_sw\", payload: washroom_fan_on} : undefined\n];\n\nreturn msg;",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 380,
        "wires": [
            [
                "ea22a8ba.b0c728",
                "9f0ab131.1e302"
            ],
            [
                "ea22a8ba.b0c728",
                "9f0ab131.1e302"
            ],
            [
                "74d29041.9a5c4"
            ]
        ]
    },
    {
        "id": "fcc6366f.aa0998",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "d": true,
        "name": "Waschküche Lüfter",
        "topic": "waschkueche_luefter/switch/switch12/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1150,
        "y": 440,
        "wires": []
    },
    {
        "id": "74d29041.9a5c4",
        "type": "ui_switch",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Lüfter",
        "label": "Lüfter",
        "tooltip": "",
        "group": "7e092ea0.4f2d9",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 830,
        "y": 440,
        "wires": [
            [
                "fcc6366f.aa0998",
                "1875623c.1159de",
                "92c6f73d.d38e98",
                "21f07479.c7da9c",
                "c8ee7404.bf05b8"
            ]
        ]
    },
    {
        "id": "d5fef74c.c342e8",
        "type": "ui_switch",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Lüfterautomatik",
        "label": "Lüfterautomatik",
        "tooltip": "",
        "group": "7e092ea0.4f2d9",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 820,
        "y": 640,
        "wires": [
            [
                "9df23e12.4321d",
                "febc79d8.468048"
            ]
        ]
    },
    {
        "id": "1875623c.1159de",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "var luefter_sw = msg.payload;\n\nconst a = global.get(\"aussen-absolute_humidity\");\nconst b = global.get(\"waschkueche_luefter-absolute_humidity\");\n\nvar h = (a > b) ? a : b;\nvar l = (a < b) ? a : b;\n\nmsg = {\n    topic: \"Lüfter\",\n    payload: (luefter_sw == \"ON\") ? h * 1.1 : l * 0.9\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 840,
        "y": 380,
        "wires": [
            [
                "ea22a8ba.b0c728",
                "9f0ab131.1e302"
            ]
        ]
    },
    {
        "id": "ea22a8ba.b0c728",
        "type": "ui_chart",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Lüfterautomatik",
        "group": "8240b43a.1094b8",
        "order": 3,
        "width": "12",
        "height": "12",
        "label": "Waschküche Lüfterautomatik",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "10",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#9477bd",
            "#e6e600",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 860,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "9c38a690.14f558",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "waschkueche_wama/sensor/power/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 340,
        "y": 900,
        "wires": [
            [
                "8fd7504b.225ed"
            ]
        ]
    },
    {
        "id": "15f3325a.1a8f0e",
        "type": "hangoutChatBot",
        "z": "4d90b497.b5b2ac",
        "hangoutsCertificate": "10925253.f46f4e",
        "roomid": "spaces/AAAAl9wJJ_0",
        "roomname": "spaces/AAAAl9wJJ_0",
        "contentproperty": "Waschmaschiene ist fertig!",
        "contenttype": "str",
        "x": 860,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "c4508389.32591",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "waschkueche_wama/sensor/temperature/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 320,
        "y": 1040,
        "wires": [
            [
                "c7cd3c7f.93d75"
            ]
        ]
    },
    {
        "id": "7b089f13.f2142",
        "type": "hangoutChatBot",
        "z": "4d90b497.b5b2ac",
        "hangoutsCertificate": "10925253.f46f4e",
        "roomid": "spaces/-fp3jQAAAAE",
        "roomname": "spaces/-fp3jQAAAAE",
        "contentproperty": "Shelly WaMa ist überhitzt!",
        "contenttype": "str",
        "x": 860,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "8fd7504b.225ed",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "var val = parseFloat(msg.payload);\nconst last_n = 30\n\nvar wama_power_last = flow.get(\"wama_power_last\") || [];\nvar wama_status = flow.get(\"wama_status\") || \"Aus\";\n\nwama_power_last.unshift(val);\nwama_power_last = wama_power_last.splice(0, last_n);\nflow.set(\"wama_power_last\", wama_power_last);\n\navg_wama_power = wama_power_last.reduce(function (accumulator, currentValue) {\n  return accumulator + currentValue;\n}, 0) / last_n;\n\n\n// Result array:\n// 0 - Hangout\n// 1 - Status text\n// 2 - debug\nmsg = [undefined, {payload: wama_status}, {payload: avg_wama_power, topic: wama_status}];\nif (wama_status == \"läuft\") {\n    if (avg_wama_power < 4.0) {\n        flow.set(\"wama_status\", \"fertig\")\n        msg = [\n            {payload: \"fertig, \" + (new Date).toLocaleTimeString()},\n            {payload: \"fertig\"},\n            {payload: avg_wama_power, topic: wama_status}\n        ];\n    }\n} else if (wama_status == \"fertig\") {\n    if (avg_wama_power < 2.0) {\n        flow.set(\"wama_status\", \"aus\")\n        msg = [\n            undefined,\n            {payload: \"aus\"},\n            {payload: avg_wama_power, topic: wama_status}\n        ];\n    } else if (avg_wama_power >= 20.0) {\n        flow.set(\"wama_status\", \"läuft\")\n        msg = [\n            undefined,\n            {payload: \"läuft\"},\n            {payload: avg_wama_power, topic: wama_status}\n        ];\n    }\n} else { // status off\n    if (avg_wama_power >= 20.0) {\n        flow.set(\"wama_status\", \"läuft\")\n        msg = [\n            undefined,\n            {payload: \"läuft\"},\n            {payload: avg_wama_power, topic: wama_status}\n        ];\n    } else if (avg_wama_power >= 2.0) {\n        flow.set(\"wama_status\", \"fertig\")\n        msg = [\n            undefined,\n            {payload: \"fertig\"},\n            {payload: avg_wama_power, topic: wama_status}\n        ];\n    }\n}\n\nreturn msg;",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 640,
        "y": 900,
        "wires": [
            [
                "15f3325a.1a8f0e"
            ],
            [
                "fd3b965b.3e6fc8"
            ],
            [
                "5f2e7e11.2be23",
                "9fbf87b9.5b6618"
            ]
        ]
    },
    {
        "id": "c7cd3c7f.93d75",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "var val = parseFloat(msg.payload);\n\nvar text, status;\nif (val > 95) {\n    msg = [\n        {payload: \"Überhitzt\"},\n        {payload: \"OFF\"}\n    ];\n} else if (val < 55) {\n    msg = [\n        undefined,\n        {payload: \"ON\"}\n    ];\n} else {\n    msg = [\n        undefined,\n        undefined\n    ];\n}\n\nreturn msg;",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 640,
        "y": 1040,
        "wires": [
            [
                "7b089f13.f2142"
            ],
            [
                "76339dfa.1244c4"
            ]
        ]
    },
    {
        "id": "76339dfa.1244c4",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "waschkueche_wama/switch/switch15/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 990,
        "y": 1060,
        "wires": []
    },
    {
        "id": "fd3b965b.3e6fc8",
        "type": "ui_text",
        "z": "4d90b497.b5b2ac",
        "group": "7e092ea0.4f2d9",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Waschmaschine/Trockner",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 910,
        "y": 900,
        "wires": []
    },
    {
        "id": "9df23e12.4321d",
        "type": "change",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "washroom_fan_control",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "17bd4566.e842bb",
        "type": "influxdb out",
        "z": "29cd7d28.a2bf92",
        "influxdb": "eeb221fb.ab27f",
        "name": "InfluxDB test",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "test",
        "retentionPolicyV18Flux": "",
        "org": "dipe",
        "bucket": "dipe-pi",
        "x": 550,
        "y": 300,
        "wires": []
    },
    {
        "id": "be93bfeb.416c4",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "single value",
        "func": "msg.payload = Math.random()*10;\nmsg.measurement = \"lala\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 300,
        "wires": [
            [
                "17bd4566.e842bb"
            ]
        ]
    },
    {
        "id": "31f9f174.ce060e",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 300,
        "wires": [
            [
                "be93bfeb.416c4"
            ]
        ]
    },
    {
        "id": "867fd718.7ce3d8",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 380,
        "wires": [
            [
                "cf6eee16.44552"
            ]
        ]
    },
    {
        "id": "cf6eee16.44552",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "Fields",
        "func": "msg.payload = {\n    intValue: '12i',\n    numValue: 123.0,\n    strValue: \"message\",\n    randomValue: Math.random()*10\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 348,
        "y": 380,
        "wires": [
            [
                "308c3ef4.09ba42"
            ]
        ]
    },
    {
        "id": "308c3ef4.09ba42",
        "type": "influxdb out",
        "z": "29cd7d28.a2bf92",
        "influxdb": "eeb221fb.ab27f",
        "name": "",
        "measurement": "test2",
        "precision": "",
        "retentionPolicy": "",
        "database": "test",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "dipe",
        "bucket": "dipe-pi",
        "x": 550,
        "y": 380,
        "wires": []
    },
    {
        "id": "b4c4515f.a28cf",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 460,
        "wires": [
            [
                "33a9b768.3496e8"
            ]
        ]
    },
    {
        "id": "33a9b768.3496e8",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "Fields and Tags",
        "func": "msg.payload = [{\n    intValue: '10i',\n    numValue: 12,\n    randomValue: Math.random()*10,\n    strValue: \"message2\"\n},\n{\n    tag1:\"sensor1\",\n    tag2:\"device2\"\n}];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 460,
        "wires": [
            [
                "b237b19.9299b5"
            ]
        ]
    },
    {
        "id": "b237b19.9299b5",
        "type": "influxdb out",
        "z": "29cd7d28.a2bf92",
        "influxdb": "eeb221fb.ab27f",
        "name": "",
        "measurement": "test2",
        "precision": "ms",
        "retentionPolicy": "",
        "database": "test",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "dipe",
        "bucket": "dipe-pi",
        "x": 610,
        "y": 460,
        "wires": []
    },
    {
        "id": "c881317a.9076",
        "type": "influxdb in",
        "z": "29cd7d28.a2bf92",
        "influxdb": "eeb221fb.ab27f",
        "name": "",
        "query": "from(bucket: \"dipe-pi\") |> range(start: -1d, stop: now())",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "dipe",
        "x": 390,
        "y": 540,
        "wires": [
            [
                "bdd8c73b.b76aa8"
            ]
        ]
    },
    {
        "id": "bdd8c73b.b76aa8",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 590,
        "y": 540,
        "wires": []
    },
    {
        "id": "2370fead.2ef3d2",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 540,
        "wires": [
            [
                "c881317a.9076"
            ]
        ]
    },
    {
        "id": "47659f9e.c7238",
        "type": "influxdb in",
        "z": "29cd7d28.a2bf92",
        "influxdb": "eeb221fb.ab27f",
        "name": "",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "org": "dipe",
        "x": 390,
        "y": 680,
        "wires": [
            [
                "b26c19f2.41f068"
            ]
        ]
    },
    {
        "id": "b26c19f2.41f068",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 590,
        "y": 680,
        "wires": []
    },
    {
        "id": "9139e4c8.cef628",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "set query",
        "func": "msg.query = 'from(bucket: \"dipe-pi\") |> range(start: -1d, stop: now())'\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 340,
        "y": 600,
        "wires": [
            [
                "47659f9e.c7238"
            ]
        ]
    },
    {
        "id": "f796cba9.8eb768",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 600,
        "wires": [
            [
                "9139e4c8.cef628"
            ]
        ]
    },
    {
        "id": "e2b3fd7e.165c4",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "to measurement",
        "func": "return {\n  measurement: msg.topic,\n  payload: msg.payload\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 980,
        "y": 120,
        "wires": [
            [
                "4c2516f0.ed40a8"
            ]
        ]
    },
    {
        "id": "4c2516f0.ed40a8",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "Filter Debug",
        "func": "function flatItem(base, key, src, dest) {\n     if (typeof src === 'undefined') {\n         return;\n     }\n     const deepKey = base.length ? base + '.' + key : key;\n     // console.log(`base=${base} key=${key} deepKey=${deepKey}`);\n     if (typeof src === 'object') {\n        if (Array.isArray(src)) {\n            src.forEach((val, idx) => flatItem(deepKey, idx, val, dest));\n        } else {\n            Object.entries(src).forEach(([key, val]) => flatItem(deepKey, key, val, dest))\n        }\n     } else {\n        dest[deepKey] = src;\n     }\n}\nif (!(\n    msg.measurement.includes('debug') ||\n    !msg.payload\n   )) {\n    let deSerialize = {};\n    let deep = msg.payload;\n    let value; \n    try {\n        deep = JSON.parse(msg.payload);\n        if (typeof deep == 'object') {\n            flatItem('', '', deep, deSerialize);\n        } else {\n           deSerialize.value = deep; \n        }\n    } catch (e) {\n    }\n    return {\n        ...msg,\n        payload: {\n            ...deSerialize,\n            val: msg.payload,\n            topic: msg.measurement\n        }\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "3f614727.989a68",
        "type": "mqtt in",
        "z": "293bb437.fa00bc",
        "name": "Kellertürschalter innen",
        "topic": "kellertuer/binary_sensor/switch2/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 100,
        "wires": [
            [
                "7e1d2b18.0c9484"
            ]
        ]
    },
    {
        "id": "ba941b0f.612f68",
        "type": "mqtt out",
        "z": "293bb437.fa00bc",
        "name": "Gartenlicht",
        "topic": "kellertuer/switch/relay2/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1070,
        "y": 100,
        "wires": []
    },
    {
        "id": "9c8ad592.66e0d8",
        "type": "mqtt out",
        "z": "293bb437.fa00bc",
        "name": "Kellertürlicht",
        "topic": "kellertuer/switch/relay1/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1070,
        "y": 300,
        "wires": []
    },
    {
        "id": "5f2e7e11.2be23",
        "type": "ui_chart",
        "z": "4d90b497.b5b2ac",
        "d": true,
        "name": "",
        "group": "8240b43a.1094b8",
        "order": 4,
        "width": 0,
        "height": 0,
        "label": "debug avg power",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "2000",
        "removeOlder": "3",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 890,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "9fbf87b9.5b6618",
        "type": "debug",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 980,
        "wires": []
    },
    {
        "id": "6c60716b.1a609",
        "type": "ui_switch",
        "z": "293bb437.fa00bc",
        "name": "Gartenlicht",
        "label": "Gartenlicht",
        "tooltip": "",
        "group": "d32aa509.f54168",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 850,
        "y": 100,
        "wires": [
            [
                "ba941b0f.612f68"
            ]
        ]
    },
    {
        "id": "3f392e15.5cb7d2",
        "type": "ui_switch",
        "z": "293bb437.fa00bc",
        "name": "Kellertürscheinwerfer",
        "label": "Kellertürscheinwerfer",
        "tooltip": "",
        "group": "d32aa509.f54168",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 880,
        "y": 300,
        "wires": [
            [
                "9c8ad592.66e0d8"
            ]
        ]
    },
    {
        "id": "ee80f561.19c918",
        "type": "mqtt in",
        "z": "293bb437.fa00bc",
        "name": "Kellertürschalter außen",
        "topic": "kellertuer/binary_sensor/switch1/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 300,
        "wires": [
            [
                "eabff51d.1ce108"
            ]
        ]
    },
    {
        "id": "7e1d2b18.0c9484",
        "type": "function",
        "z": "293bb437.fa00bc",
        "name": "toggle",
        "func": "if (msg.payload != \"ON\")\n    return undefined;\n\nvar topic = \"gartenlicht\";\nvar current_state = flow.get(topic);\nvar new_state;\n\nif (current_state === \"OFF\") {\n    new_state = \"ON\";\n} else {\n    new_state = \"OFF\";\n}\n\nflow.set(topic, new_state);\n\nreturn {payload: new_state};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 710,
        "y": 100,
        "wires": [
            [
                "6c60716b.1a609"
            ]
        ]
    },
    {
        "id": "b529a82a.481848",
        "type": "mqtt out",
        "z": "3a471104.edfbae",
        "name": "Treppemnhauslicht",
        "topic": "treppenhaus_gaeste_wc/switch/relay1/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1170,
        "y": 220,
        "wires": []
    },
    {
        "id": "e3b87d0f.108a9",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "",
        "topic": "treppenhaus_gaeste_wc/binary_sensor/button1/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 260,
        "y": 40,
        "wires": [
            [
                "dba6f56.3127408"
            ]
        ]
    },
    {
        "id": "c07473f0.eb252",
        "type": "ui_switch",
        "z": "3a471104.edfbae",
        "name": "Treppenhaus",
        "label": "Treppenhaus",
        "tooltip": "",
        "group": "64b01bd0.e1d1b4",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "treppenhaus",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 770,
        "y": 220,
        "wires": [
            [
                "4907d5.d804982c",
                "553fc166.0b31c"
            ]
        ]
    },
    {
        "id": "153c328e.15de1d",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "Bewegungsmelder Treppenhaus4",
        "topic": "zigbee2mqtt/bewegungsmelder_treppenhaus4",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 220,
        "wires": [
            [
                "858eda45.27c1d8",
                "2d02fbe.4c51a04"
            ]
        ]
    },
    {
        "id": "c473a018.46907",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "map occupancy to ON",
        "func": "if (msg.payload[\"occupancy\"])\n    return {payload: \"ON\"}\nelse \n    return undefined;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 220,
        "wires": [
            [
                "c07473f0.eb252"
            ]
        ]
    },
    {
        "id": "dba6f56.3127408",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "toggle state",
        "func": "if (msg.payload != \"ON\") { // taster is inverted :/\n    return undefined;\n}\n\nvar topic = \"treppenhaustaster\";\nvar current_state = flow.get(topic);\n\nif (current_state === \"OFF\")\n    return {payload: \"ON\"}\nelse\n    return {payload: \"OFF\"};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 40,
        "wires": [
            [
                "c07473f0.eb252"
            ]
        ]
    },
    {
        "id": "4907d5.d804982c",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "filter ON",
        "func": "if (msg.payload === \"ON\")\n    return {payload: \"ON\"}\nelse\n    return undefined;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 320,
        "wires": [
            [
                "1bf72870.060278"
            ]
        ]
    },
    {
        "id": "553fc166.0b31c",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "save state",
        "func": "flow.set(\"treppenhaustaster\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 220,
        "wires": [
            [
                "b529a82a.481848"
            ]
        ]
    },
    {
        "id": "2122f69.fdedd0a",
        "type": "mqtt in",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "topic": "sensors/#",
        "broker": "e8ee0bf9.1711f8",
        "x": 400,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "bbed4e22.4412b",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "MQTT to InfluxDB",
        "func": "var tokens = msg.topic.split(\"/\");\nvar dest = tokens[tokens.length-1];\nmsg.url =\"http://localhost:8086/write?db=greenhouse\";\nmsg.payload = tokens[2] + \",device=\" + tokens[1] + \" value=\" + msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 619,
        "y": 742,
        "wires": [
            [
                "92e875bf.6d1788",
                "7804637a.87fb9c"
            ]
        ]
    },
    {
        "id": "92e875bf.6d1788",
        "type": "http request",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "url": "http://localhost:8086/write?db=greenhouse",
        "x": 842,
        "y": 741,
        "wires": [
            [
                "989defec.67621"
            ]
        ]
    },
    {
        "id": "989defec.67621",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "true",
        "x": 1036,
        "y": 740,
        "wires": []
    },
    {
        "id": "7804637a.87fb9c",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 826,
        "y": 881,
        "wires": []
    },
    {
        "id": "1c86fb0b.6322c5",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "Bewegungsmelder Treppenhaus3",
        "topic": "zigbee2mqtt/bewegungsmelder_treppenhaus3",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 180,
        "wires": [
            [
                "858eda45.27c1d8"
            ]
        ]
    },
    {
        "id": "c8229850.b97058",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "Bewegungsmelder Treppenhaus2",
        "topic": "zigbee2mqtt/bewegungsmelder_treppenhaus2",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 140,
        "wires": [
            [
                "858eda45.27c1d8"
            ]
        ]
    },
    {
        "id": "cf66c5f7.71d4e8",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "Bewegungsmelder Treppenhaus1",
        "topic": "zigbee2mqtt/bewegungsmelder_treppenhaus1",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 100,
        "wires": [
            [
                "858eda45.27c1d8"
            ]
        ]
    },
    {
        "id": "6de264d6.e9f88c",
        "type": "mqtt in",
        "z": "293bb437.fa00bc",
        "name": "Fernbedienung Balkontür",
        "topic": "zigbee2mqtt/fernbedienung_balkontuer",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 190,
        "y": 220,
        "wires": [
            [
                "851693ee.65c15"
            ]
        ]
    },
    {
        "id": "851693ee.65c15",
        "type": "switch",
        "z": "293bb437.fa00bc",
        "name": "action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_move_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_move_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_stop",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 390,
        "y": 220,
        "wires": [
            [
                "89f0fbf4.8c0958"
            ],
            [
                "3191ad6d.ff0602"
            ],
            [],
            [],
            []
        ]
    },
    {
        "id": "89f0fbf4.8c0958",
        "type": "template",
        "z": "293bb437.fa00bc",
        "name": "ON",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "ON",
        "output": "str",
        "x": 550,
        "y": 140,
        "wires": [
            [
                "7e1d2b18.0c9484"
            ]
        ]
    },
    {
        "id": "3191ad6d.ff0602",
        "type": "template",
        "z": "293bb437.fa00bc",
        "name": "ON",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "ON",
        "output": "str",
        "x": 550,
        "y": 260,
        "wires": [
            [
                "eabff51d.1ce108"
            ]
        ]
    },
    {
        "id": "eabff51d.1ce108",
        "type": "function",
        "z": "293bb437.fa00bc",
        "name": "toggle",
        "func": "if (msg.payload != \"ON\")\n    return undefined;\n\nvar topic = \"kellertürlicht\";\nvar current_state = flow.get(topic);\nvar new_state;\n\nif (current_state === \"OFF\") {\n    new_state = \"ON\";\n} else {\n    new_state = \"OFF\";\n}\n\nflow.set(topic, new_state);\n\nreturn {payload: new_state};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 710,
        "y": 300,
        "wires": [
            [
                "3f392e15.5cb7d2"
            ]
        ]
    },
    {
        "id": "bb3b7629.ab9698",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "",
        "topic": "treppenhaus_eg/binary_sensor/taster/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 220,
        "y": 440,
        "wires": [
            [
                "9e0605ed.8497b8"
            ]
        ]
    },
    {
        "id": "b187a14.548406",
        "type": "mqtt out",
        "z": "3a471104.edfbae",
        "name": "",
        "topic": "treppenhaus_keller/switch/relay1/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1270,
        "y": 460,
        "wires": []
    },
    {
        "id": "41e39711.b892e8",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "save state",
        "func": "flow.set(\"treppenhaus_kellerlicht\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 460,
        "wires": [
            [
                "b187a14.548406"
            ]
        ]
    },
    {
        "id": "3eb024a5.e9f9bc",
        "type": "ui_switch",
        "z": "3a471104.edfbae",
        "name": "Treppenhaus Keller",
        "label": "Treppenhaus Keller",
        "tooltip": "",
        "group": "64b01bd0.e1d1b4",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "treppenhaus_keller",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 790,
        "y": 460,
        "wires": [
            [
                "41e39711.b892e8",
                "4907d5.d804982c"
            ]
        ]
    },
    {
        "id": "5a9ba8dd.c08758",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "3",
        "func": "msg.payload = 3;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 300,
        "wires": [
            [
                "5e79d51e.9213dc"
            ]
        ]
    },
    {
        "id": "38bf3abf.87fe76",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "map occupancy to ON",
        "func": "if (msg.payload[\"occupancy\"])\n    return {payload: \"ON\"}\nelse \n    return undefined;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 380,
        "wires": [
            [
                "3eb024a5.e9f9bc"
            ]
        ]
    },
    {
        "id": "1bf72870.060278",
        "type": "trigger",
        "z": "3a471104.edfbae",
        "name": "Treppenhausautomat",
        "op1": "",
        "op2": "OFF",
        "op1type": "nul",
        "op2type": "str",
        "duration": "2",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 800,
        "y": 320,
        "wires": [
            [
                "c07473f0.eb252",
                "3eb024a5.e9f9bc"
            ]
        ]
    },
    {
        "id": "12ebb575.a874db",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "3825ae1b.6847c2",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "Lüftungsempfehlung",
        "func": "const name = msg.payload.name;\n\nconst temperature = global.get(name + \"-temperature\");\nconst humidity = global.get(name + \"-humidity\");\nconst abs_humidity = global.get(name + \"-absolute_humidity\");\nconst last_abs_humidity_gt_outside_abs_humidity = global.get(name + \"-last_abs_humidity_gt_outside_abs_humidity\");\nconst outside_abs_humidity = global.get(\"aussen-absolute_humidity\");\n\nconst room_abs_humidity_gt_outside_abs_humidity = (last_abs_humidity_gt_outside_abs_humidity) ?\n    abs_humidity > outside_abs_humidity * 1.05 :\n    abs_humidity > outside_abs_humidity;\n\nglobal.set(name + \"-last_abs_humidity_gt_outside_abs_humidity\", abs_humidity > outside_abs_humidity);\n\nconst intl = global.get('intl');\nconst format = intl.NumberFormat('de-De',{style:'decimal', maximumFractionDigits: 2}).format;\nconst sprintf = global.get(\"sprintf\");\nconst text = sprintf(\"%s °C, %s %% H, %s g/m³\", format(temperature), format(humidity), format(abs_humidity))\n\nif (false) {\n    node.warn(\"--------------------------------------\")\n    node.warn(\"name: \" + name)\n    node.warn(\"temperature: \" + temperature)\n    node.warn(\"humidity: \" + humidity)\n    node.warn(\"abs_humidity: \" + abs_humidity)\n    node.warn(\"last_abs_humidity_gt_outside_abs_humidity: \" + last_abs_humidity_gt_outside_abs_humidity)\n    node.warn(\"outside_abs_humidity: \" + outside_abs_humidity)\n    node.warn(\"room_abs_humidity_gt_outside_abs_humidity: \" + room_abs_humidity_gt_outside_abs_humidity)\n    node.warn(\"text: \" + text)\n}\n\n\n\nif (room_abs_humidity_gt_outside_abs_humidity) {\n    if (humidity > 65) {\n        return {payload: {name: name, color: \"skyblue\", hint: \"Raum feucht. Lüften!\", text: text}};\n    } else {\n        return {payload: {name: name, color: \"limegreen\", hint: \"Raum ausreichend trocken.\", text: text}};\n    }\n} else {\n    return {payload: {name: name, color: \"red\", hint: \"Draußen feuchter. Nur kurz lüften!\", text: text}};\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 560,
        "wires": [
            [
                "dac326a7.c5d638"
            ]
        ]
    },
    {
        "id": "858eda45.27c1d8",
        "type": "delay",
        "z": "3a471104.edfbae",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 480,
        "y": 160,
        "wires": [
            [
                "c473a018.46907"
            ]
        ]
    },
    {
        "id": "2d02fbe.4c51a04",
        "type": "delay",
        "z": "3a471104.edfbae",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 280,
        "y": 380,
        "wires": [
            [
                "38bf3abf.87fe76"
            ]
        ]
    },
    {
        "id": "b56cd25f.124c9",
        "type": "ui_gauge",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Luftfeuchtigkeit",
        "group": "7e092ea0.4f2d9",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Luftfeuchtigkeit",
        "label": "% rel.",
        "format": "{{value}}",
        "min": "20",
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "35",
        "seg2": "65",
        "x": 860,
        "y": 180,
        "wires": []
    },
    {
        "id": "a7962ae6.cd51d8",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 890,
        "y": 1460,
        "wires": []
    },
    {
        "id": "358305f.dcbedfa",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1110,
        "y": 1600,
        "wires": []
    },
    {
        "id": "e2c05c.824aafa8",
        "type": "delay",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "10",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 1430,
        "y": 1520,
        "wires": [
            [
                "ce33b77e.42e888"
            ]
        ]
    },
    {
        "id": "483939cf.9e9258",
        "type": "ui_toast",
        "z": "29cd7d28.a2bf92",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "KlugesHaus",
        "x": 1110,
        "y": 1340,
        "wires": []
    },
    {
        "id": "3a992371.47ad1c",
        "type": "ui_button",
        "z": "29cd7d28.a2bf92",
        "name": "Livingroom boost",
        "group": "ec48ea8.9196518",
        "order": 23,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Livingroom boost",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "boost",
        "payloadType": "str",
        "topic": "",
        "x": 1130,
        "y": 1560,
        "wires": [
            [
                "e2c05c.824aafa8"
            ]
        ]
    },
    {
        "id": "db46f953.f26e68",
        "type": "ui_text",
        "z": "29cd7d28.a2bf92",
        "group": "ec48ea8.9196518",
        "order": 29,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Bat livingroom:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 900,
        "y": 1280,
        "wires": []
    },
    {
        "id": "8b75b2d5.c8baa",
        "type": "ui_text",
        "z": "29cd7d28.a2bf92",
        "group": "ec48ea8.9196518",
        "order": 25,
        "width": 0,
        "height": 0,
        "name": "Is temp livingroom",
        "label": "Is temp livingroom:",
        "format": "{{msg.payload}}°C",
        "layout": "row-spread",
        "x": 910,
        "y": 1420,
        "wires": []
    },
    {
        "id": "533ab806.c07cb8",
        "type": "ui_dropdown",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "label": "Livingroom target temp",
        "tooltip": "",
        "place": "Temperatur",
        "group": "ec48ea8.9196518",
        "order": 28,
        "width": 0,
        "height": 0,
        "passthru": false,
        "multiple": true,
        "options": [
            {
                "label": "",
                "value": 13,
                "type": "num"
            },
            {
                "label": "",
                "value": 14,
                "type": "num"
            },
            {
                "label": "",
                "value": 15,
                "type": "num"
            },
            {
                "label": "",
                "value": 16,
                "type": "num"
            },
            {
                "label": "",
                "value": 17,
                "type": "num"
            },
            {
                "label": "",
                "value": 18,
                "type": "num"
            },
            {
                "label": "",
                "value": 19,
                "type": "num"
            },
            {
                "label": "",
                "value": 20,
                "type": "num"
            },
            {
                "label": "",
                "value": 21,
                "type": "num"
            },
            {
                "label": "",
                "value": 22,
                "type": "num"
            },
            {
                "label": "",
                "value": 23,
                "type": "num"
            },
            {
                "label": "",
                "value": 24,
                "type": "num"
            },
            {
                "label": "",
                "value": 25,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "x": 1140,
        "y": 1520,
        "wires": [
            [
                "e2c05c.824aafa8"
            ]
        ]
    },
    {
        "id": "e5048a7a.b2d4a8",
        "type": "ui_gauge",
        "z": "29cd7d28.a2bf92",
        "name": "Livingroom Temperature",
        "group": "ec48ea8.9196518",
        "order": 21,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Livingroom ",
        "label": "°C",
        "format": "{{value}}",
        "min": "10",
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 1150,
        "y": 1420,
        "wires": []
    },
    {
        "id": "fab61adb.8e4ef8",
        "type": "trigger",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "op1": "Heizung WZ Batterie leer",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "0",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 910,
        "y": 1360,
        "wires": [
            [
                "483939cf.9e9258"
            ]
        ]
    },
    {
        "id": "e7e1539f.66fea",
        "type": "comment",
        "z": "29cd7d28.a2bf92",
        "name": "Get device info / Geräteinfo anfordern",
        "info": "",
        "x": 150,
        "y": 1180,
        "wires": []
    },
    {
        "id": "7b162249.11acbc",
        "type": "fritz-thermostat",
        "z": "29cd7d28.a2bf92",
        "connection": "c2e6322e.33404",
        "name": "",
        "action": "getDevice",
        "x": 370,
        "y": 1240,
        "wires": [
            [
                "56356228.cf8fec",
                "2c507a36.fbb3c6",
                "45d087bf.aab698",
                "cdfaff2e.e8955",
                "8c417156.f97f",
                "4839f59f.2d4bac",
                "56a0e5c3.3ae8cc",
                "6147fb8d.a3eda4",
                "7e243a3.2ef85c4"
            ]
        ]
    },
    {
        "id": "56356228.cf8fec",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 530,
        "y": 1200,
        "wires": []
    },
    {
        "id": "988fe74d.d62688",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "inject heater_id",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "099950702018",
        "payload": "",
        "payloadType": "str",
        "x": 180,
        "y": 1240,
        "wires": [
            [
                "7b162249.11acbc"
            ]
        ]
    },
    {
        "id": "ce33b77e.42e888",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "inject heater_id",
        "rules": [
            {
                "t": "set",
                "p": "ain",
                "pt": "msg",
                "to": "099950439688",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1420,
        "y": 1580,
        "wires": [
            [
                "88de62a8.94557",
                "36116ab4.f72696"
            ]
        ]
    },
    {
        "id": "88de62a8.94557",
        "type": "fritz-thermostat",
        "z": "29cd7d28.a2bf92",
        "connection": "c2e6322e.33404",
        "name": "",
        "action": "setTempTarget",
        "x": 1390,
        "y": 1660,
        "wires": [
            [
                "94392c0d.00301"
            ]
        ]
    },
    {
        "id": "2c507a36.fbb3c6",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "battery",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.battery",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1280,
        "wires": [
            [
                "4447bfbb.2f313",
                "db46f953.f26e68"
            ]
        ]
    },
    {
        "id": "4447bfbb.2f313",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 1280,
        "wires": []
    },
    {
        "id": "45d087bf.aab698",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "name",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.name",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1320,
        "wires": [
            [
                "8ac5de97.e5d21"
            ]
        ]
    },
    {
        "id": "8ac5de97.e5d21",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 1320,
        "wires": []
    },
    {
        "id": "cdfaff2e.e8955",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "batterylow",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.batterylow",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 1360,
        "wires": [
            [
                "df36ec43.f77e",
                "fab61adb.8e4ef8"
            ]
        ]
    },
    {
        "id": "df36ec43.f77e",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 1360,
        "wires": []
    },
    {
        "id": "8c417156.f97f",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "present",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.present",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 1400,
        "wires": [
            [
                "dd12c973.b2b518"
            ]
        ]
    },
    {
        "id": "dd12c973.b2b518",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 1400,
        "wires": []
    },
    {
        "id": "4839f59f.2d4bac",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "is_temperature",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.temperature.celsius",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1560,
        "wires": [
            [
                "64cf4cb.66c1eb4"
            ]
        ]
    },
    {
        "id": "5290e091.d6486",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "convert_t_to_celsius",
        "func": "msg.payload=msg.payload*0.5;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 840,
        "y": 1600,
        "wires": [
            [
                "533ab806.c07cb8",
                "358305f.dcbedfa",
                "e5048a7a.b2d4a8"
            ]
        ]
    },
    {
        "id": "56a0e5c3.3ae8cc",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "target_temperature",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.hkr.tsoll",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1600,
        "wires": [
            [
                "5290e091.d6486"
            ]
        ]
    },
    {
        "id": "addcb097.29cee",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "convert_t_to_celsius",
        "func": "msg.payload=msg.payload</em>0.5;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 840,
        "y": 1640,
        "wires": [
            [
                "dad67a3a.2241d8"
            ]
        ]
    },
    {
        "id": "6147fb8d.a3eda4",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "power_down_temperature",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.hkr.absenk",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 1640,
        "wires": [
            [
                "addcb097.29cee"
            ]
        ]
    },
    {
        "id": "dad67a3a.2241d8",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1110,
        "y": 1640,
        "wires": []
    },
    {
        "id": "e9015a7c.bdb0d8",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "convert_t_to_celsius",
        "func": "msg.payload=msg.payload*0.5;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 840,
        "y": 1680,
        "wires": [
            [
                "7e2bb922.138358"
            ]
        ]
    },
    {
        "id": "7e243a3.2ef85c4",
        "type": "change",
        "z": "29cd7d28.a2bf92",
        "name": "comfort_temperature",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.hkr.komfort",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 1680,
        "wires": [
            [
                "e9015a7c.bdb0d8"
            ]
        ]
    },
    {
        "id": "7e2bb922.138358",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1110,
        "y": 1680,
        "wires": []
    },
    {
        "id": "94392c0d.00301",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1550,
        "y": 1660,
        "wires": []
    },
    {
        "id": "36116ab4.f72696",
        "type": "delay",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 320,
        "y": 1340,
        "wires": [
            [
                "7b162249.11acbc"
            ]
        ]
    },
    {
        "id": "36ee37a8.465248",
        "type": "link in",
        "z": "29cd7d28.a2bf92",
        "name": "set heater_temp",
        "links": [
            "de5934df.32da48"
        ],
        "x": 1275,
        "y": 1580,
        "wires": [
            [
                "ce33b77e.42e888"
            ]
        ]
    },
    {
        "id": "ec242dc3.9023f",
        "type": "inject",
        "z": "29cd7d28.a2bf92",
        "name": "boost",
        "props": [
            {
                "p": "payload",
                "v": "boost",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "boost",
        "payloadType": "str",
        "x": 1110,
        "y": 1480,
        "wires": [
            [
                "e2c05c.824aafa8"
            ]
        ]
    },
    {
        "id": "64cf4cb.66c1eb4",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "convert_t_to_celsius",
        "func": "msg.payload=msg.payload/10;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 840,
        "y": 1560,
        "wires": [
            [
                "a7962ae6.cd51d8",
                "8b75b2d5.c8baa"
            ]
        ]
    },
    {
        "id": "3172152d.756fca",
        "type": "mqtt in",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "topic": "+/sensor/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 980,
        "wires": [
            [
                "fa653882.db1888"
            ]
        ]
    },
    {
        "id": "8a7dceed.4e5f3",
        "type": "influxdb out",
        "z": "29cd7d28.a2bf92",
        "d": true,
        "influxdb": "eeb221fb.ab27f",
        "name": "InfluxDB",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "test",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "dipe",
        "bucket": "dipe-pi",
        "x": 660,
        "y": 1020,
        "wires": []
    },
    {
        "id": "fa653882.db1888",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "ESPHOME to InfluxDB",
        "func": "var value;\nif(/^(\\-|\\+)?([0-9]+(\\.[0-9]+)?)$/.test(msg.payload)) {\n  value = Number(msg.payload);\n} else {\n  value = msg.payload;\n}\n\nvar tokens = msg.topic.split(\"/\");\nvar sensor = tokens[0];\nvar measurement = tokens[2];\nmsg.measurement = sensor;\n\nmsg.payload = {};\nmsg.payload[measurement] = value;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 980,
        "wires": [
            [
                "8f32de13.4210f",
                "8a7dceed.4e5f3"
            ]
        ]
    },
    {
        "id": "784dee11.31f2a",
        "type": "mqtt in",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "topic": "zigbee2mqtt/+",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 1060,
        "wires": [
            [
                "fe17d2f8.8072f"
            ]
        ]
    },
    {
        "id": "fe17d2f8.8072f",
        "type": "function",
        "z": "29cd7d28.a2bf92",
        "name": "ZIGBEE2MQTT to InfluxDB",
        "func": "function flatItem(base, key, src, dest) {\n     if (typeof src === 'undefined') {\n         return;\n     }\n     const deepKey = base.length ? base + '.' + key : key;\n     // console.log(`base=${base} key=${key} deepKey=${deepKey}`);\n     if (typeof src === 'object') {\n        if (Array.isArray(src)) {\n            src.forEach((val, idx) => flatItem(deepKey, idx, val, dest));\n        } else {\n            Object.entries(src).forEach(([key, val]) => flatItem(deepKey, key, val, dest))\n        }\n     } else {\n        dest[deepKey] = src;\n     }\n}\n\nlet deSerialize = {};\nlet deep = msg.payload;\nlet value; \ntry {\n    deep = JSON.parse(msg.payload);\n    if (typeof deep == 'object') {\n        flatItem('', '', deep, deSerialize);\n    } else {\n       deSerialize.value = deep; \n    }\n} catch (e) {\n}\n\nvar tokens = msg.topic.split(\"/\");\nvar sensor = tokens[1];\nmsg.measurement = sensor;\nmsg.payload = deSerialize;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1060,
        "wires": [
            [
                "8f32de13.4210f",
                "8a7dceed.4e5f3"
            ]
        ]
    },
    {
        "id": "8f32de13.4210f",
        "type": "debug",
        "z": "29cd7d28.a2bf92",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 960,
        "wires": []
    },
    {
        "id": "86ad9def.8aa5c",
        "type": "mqtt in",
        "z": "2f328ad8.26ca86",
        "name": "",
        "topic": "stromzaehler/sensor/1/obis/1-0:16.7.0/255/value",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 320,
        "y": 140,
        "wires": [
            [
                "ea99ed95.a6b5f"
            ]
        ]
    },
    {
        "id": "2dcf1032.d990b",
        "type": "mqtt in",
        "z": "2f328ad8.26ca86",
        "name": "",
        "topic": "stromzaehler/sensor/1/obis/1-0:1.8.0/255/value",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 320,
        "y": 200,
        "wires": [
            [
                "8452f01b.9b7a2",
                "137fe45c.47150c"
            ]
        ]
    },
    {
        "id": "fc831115.7e04a",
        "type": "mqtt in",
        "z": "d0173d54.941d7",
        "name": "",
        "topic": "+/+/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 160,
        "y": 200,
        "wires": [
            [
                "681998dd.099198"
            ]
        ]
    },
    {
        "id": "faa25f7f.0777",
        "type": "influxdb out",
        "z": "d0173d54.941d7",
        "influxdb": "eeb221fb.ab27f",
        "name": "InfluxDB",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "database": "adh29",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "dipe",
        "bucket": "dipe-pi",
        "x": 980,
        "y": 300,
        "wires": []
    },
    {
        "id": "681998dd.099198",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "ESPHOME to InfluxDB",
        "func": "const tokens = msg.topic.split(\"/\");\n\nif (tokens[1] == \"debug\") {\n    return;\n}\n\nvar value;\nif(/^(\\-|\\+)?([0-9]+(\\.[0-9]+)?)$/.test(msg.payload)) {\n  value = Number(msg.payload);\n} else {\n  value = msg.payload;\n}\n\nconst measurement = tokens[0];\n\nmsg.measurement = measurement;\nmsg.payload = {};\nmsg.payload[tokens[2]] = value;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 180,
        "wires": [
            [
                "943e53d.5cc18b",
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "6d729e00.24b394",
        "type": "mqtt in",
        "z": "d0173d54.941d7",
        "name": "",
        "topic": "zigbee2mqtt/+",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 300,
        "wires": [
            [
                "54e7d479.9e81bc"
            ]
        ]
    },
    {
        "id": "fa0231fe.d86ab",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "ZIGBEE2MQTT to InfluxDB",
        "func": "function flatItem(base, key, src, dest) {\n     if (typeof src === 'undefined') {\n         return;\n     }\n     const deepKey = base.length ? base + '.' + key : key;\n     // console.log(`base=${base} key=${key} deepKey=${deepKey}`);\n     if (typeof src === 'object') {\n        if (Array.isArray(src)) {\n            src.forEach((val, idx) => flatItem(deepKey, idx, val, dest));\n        } else {\n            Object.entries(src).forEach(([key, val]) => flatItem(deepKey, key, val, dest))\n        }\n     } else {\n        dest[deepKey] = src;\n     }\n}\n\nlet deSerialize = {};\nlet deep = msg.payload;\nlet value; \ntry {\n    deep = JSON.parse(msg.payload);\n    if (typeof deep == 'object') {\n        flatItem('', '', deep, deSerialize);\n    } else {\n       deSerialize.value = deep; \n    }\n} catch (e) {\n}\n\nconst tokens = msg.topic.split(\"/\");\nconst measurement = tokens[1].replace(/ /g, '_').toLowerCase();\nmsg.measurement = measurement;\nmsg.payload = deSerialize;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 660,
        "y": 300,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "943e53d.5cc18b",
        "type": "debug",
        "z": "d0173d54.941d7",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 180,
        "wires": []
    },
    {
        "id": "56b0182.c2cb1e8",
        "type": "mqtt in",
        "z": "d0173d54.941d7",
        "name": "",
        "topic": "+/+/+/command",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 180,
        "y": 240,
        "wires": [
            [
                "681998dd.099198"
            ]
        ]
    },
    {
        "id": "fb23ed2a.5d3d1",
        "type": "mqtt in",
        "z": "d0173d54.941d7",
        "name": "",
        "topic": "+/debug",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "681998dd.099198"
            ]
        ]
    },
    {
        "id": "9c0d621e.c88d8",
        "type": "mqtt in",
        "z": "d0173d54.941d7",
        "name": "",
        "topic": "+/uptime",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "681998dd.099198"
            ]
        ]
    },
    {
        "id": "7c6e00fe.37756",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "SDL to InfluxDB",
        "func": "var value;\nif(/^(\\-|\\+)?([0-9]+(\\.[0-9]+)?)$/.test(msg.payload)) {\n  value = Number(msg.payload);\n} else {\n  value = msg.payload;\n}\n\n\n\nmsg.measurement = \"stromzähler\";\nmsg.payload = {};\nmsg.payload[\"counter\"] = value;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 440,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "e9ca4023.2c05e",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "SDL to InfluxDB",
        "func": "var value;\nif(/^(\\-|\\+)?([0-9]+(\\.[0-9]+)?)$/.test(msg.payload)) {\n  value = Number(msg.payload);\n} else {\n  value = msg.payload;\n}\n\n\n\nmsg.measurement = \"stromzähler\";\nmsg.payload = {};\nmsg.payload[\"consumption\"] = value;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 480,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "ea99ed95.a6b5f",
        "type": "link out",
        "z": "2f328ad8.26ca86",
        "name": "Stromaufnahme",
        "links": [
            "cf2bd5c4.367d88"
        ],
        "x": 555,
        "y": 140,
        "wires": []
    },
    {
        "id": "8452f01b.9b7a2",
        "type": "link out",
        "z": "2f328ad8.26ca86",
        "name": "Stromzählerstand",
        "links": [
            "cbdd2a4.e9dcad8"
        ],
        "x": 555,
        "y": 200,
        "wires": []
    },
    {
        "id": "678631ab.fe1bb",
        "type": "link out",
        "z": "2f328ad8.26ca86",
        "name": "DSL Downstream",
        "links": [
            "c464d2a1.b031e"
        ],
        "x": 735,
        "y": 60,
        "wires": []
    },
    {
        "id": "9d0190fe.0d3fe",
        "type": "link out",
        "z": "2f328ad8.26ca86",
        "name": "DSL Upstream",
        "links": [
            "e94f62b.6a086a"
        ],
        "x": 735,
        "y": 100,
        "wires": []
    },
    {
        "id": "cbdd2a4.e9dcad8",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "",
        "links": [
            "8452f01b.9b7a2"
        ],
        "x": 415,
        "y": 440,
        "wires": [
            [
                "7c6e00fe.37756"
            ]
        ]
    },
    {
        "id": "cf2bd5c4.367d88",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "",
        "links": [
            "ea99ed95.a6b5f"
        ],
        "x": 415,
        "y": 480,
        "wires": [
            [
                "e9ca4023.2c05e"
            ]
        ]
    },
    {
        "id": "c464d2a1.b031e",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "",
        "links": [
            "678631ab.fe1bb"
        ],
        "x": 415,
        "y": 540,
        "wires": [
            [
                "18f89cba.858903"
            ]
        ]
    },
    {
        "id": "e94f62b.6a086a",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "",
        "links": [
            "9d0190fe.0d3fe"
        ],
        "x": 415,
        "y": 580,
        "wires": [
            [
                "2e920011.62b1e"
            ]
        ]
    },
    {
        "id": "18f89cba.858903",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "DSL downstream to InfluxDB",
        "func": "var value = msg.payload;\nmsg.payload = {downstream: value};\nmsg.measurement = \"dsl\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 540,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "2e920011.62b1e",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "DSL upstream to InfluxDB",
        "func": "var value = msg.payload;\nmsg.payload = {upstream: value};\nmsg.measurement = \"dsl\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 580,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "89e98409.0b1d08",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 4,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "8fc7d555.415c28",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 5,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "d7a58b62.d342b8",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "openweather to InfluxDB",
        "func": "msg.measurement = \"open_weather\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 640,
        "wires": [
            [
                "faa25f7f.0777",
                "35463b9.854cac4"
            ]
        ]
    },
    {
        "id": "9b9574d4.b3d108",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "openweather",
        "links": [
            "f562ddab.6a9d3"
        ],
        "x": 415,
        "y": 640,
        "wires": [
            [
                "d7a58b62.d342b8"
            ]
        ]
    },
    {
        "id": "f24eda7c.102788",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "store global",
        "func": "var val = parseFloat(msg.payload);\nglobal.set(\"waschküche-humidity\", val);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "8f4a8f67.f0316",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "",
        "func": "const hint = msg.payload.hint;\nconst text = msg.payload.text;\n\nconst lh = flow.get(\"lueftungsempfehlungen_hint\") || {};\n\nif (lh != hint) {\n    flow.set(\"lueftungsempfehlungen_hint\", hint);\n    return {payload: `${hint}\\n${text}\\nmehr: http://dipe-pi:1880/ui/#!/7?socketid=xoYPAh22ZP1gOFpmAAAA`};\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 860,
        "y": 420,
        "wires": [
            [
                "bea87736.5db2d8"
            ]
        ]
    },
    {
        "id": "bea87736.5db2d8",
        "type": "hangoutChatBot",
        "z": "2788b93b.8a2f56",
        "hangoutsCertificate": "10925253.f46f4e",
        "roomid": "spaces/-fp3jQAAAAE",
        "roomname": "spaces/-fp3jQAAAAE",
        "contentproperty": "payload",
        "contenttype": "msg",
        "x": 860,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "92221171.b4219",
        "type": "delay",
        "z": "2788b93b.8a2f56",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "hour",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 880,
        "y": 380,
        "wires": [
            [
                "8f4a8f67.f0316"
            ]
        ]
    },
    {
        "id": "43093632.8aef48",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state ON_",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"ON\"}",
        "output": "json",
        "x": 620,
        "y": 880,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "40e09b5.33b3964",
        "type": "mqtt out",
        "z": "37daec28.284ee4",
        "name": "Tiffany",
        "topic": "zigbee2mqtt/tiffany/set",
        "qos": "1",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 970,
        "y": 880,
        "wires": []
    },
    {
        "id": "792c807c.de0c7",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Tiffany",
        "topic": "zigbee2mqtt/tiffany",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1150,
        "y": 880,
        "wires": [
            [
                "61308a38.c34a64"
            ]
        ]
    },
    {
        "id": "61308a38.c34a64",
        "type": "json",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1310,
        "y": 880,
        "wires": [
            [
                "52aea2ca.07744c",
                "7e4ae382.f3381c",
                "9762023d.37de7"
            ]
        ]
    },
    {
        "id": "5733229f.07166c",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state OFF",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"OFF\"}",
        "output": "json",
        "x": 620,
        "y": 920,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "52aea2ca.07744c",
        "type": "change",
        "z": "37daec28.284ee4",
        "name": "save tiffany state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "tiffany",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 920,
        "wires": [
            [
                "35891aa8.d828c6"
            ]
        ]
    },
    {
        "id": "19c44039.99c12",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "increment tiffany brightness",
        "func": "var leuchter = flow.get(\"tiffany\")\n\nleuchter[\"brightness\"] += 25;\nif (leuchter[\"brightness\"] > 254) {\n    leuchter[\"brightness\"] = 254;\n}\n\nflow.set(\"tiffany\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 680,
        "y": 960,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "518a8c36.6f0c54",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "decrement tiffany brightness",
        "func": "var leuchter = flow.get(\"tiffany\")\n\nleuchter[\"brightness\"] -= 10;\nif (leuchter[\"brightness\"] < 0) {\n    leuchter[\"brightness\"] = 0;\n}\nflow.set(\"tiffany\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 680,
        "y": 1000,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "b9e6bfe3.96c8f",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "Action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_max",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_min",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 430,
        "y": 980,
        "wires": [
            [
                "43093632.8aef48"
            ],
            [
                "5733229f.07166c"
            ],
            [
                "19c44039.99c12"
            ],
            [
                "518a8c36.6f0c54"
            ],
            [
                "7d753f2a.b57c8"
            ],
            [
                "1cfacdb1.b56382"
            ]
        ],
        "outputLabels": [
            "brightness_up_click",
            "brightness_down_click",
            "",
            "",
            "",
            ""
        ]
    },
    {
        "id": "7d753f2a.b57c8",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 254",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 254}",
        "output": "json",
        "x": 640,
        "y": 1040,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "1cfacdb1.b56382",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 1",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 1}",
        "output": "json",
        "x": 630,
        "y": 1080,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "35891aa8.d828c6",
        "type": "debug",
        "z": "37daec28.284ee4",
        "name": "Tiffany",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 960,
        "wires": []
    },
    {
        "id": "30c5bc34.3c3974",
        "type": "ui_switch",
        "z": "37daec28.284ee4",
        "name": "An/Aus Tiffany",
        "label": "An/Aus",
        "tooltip": "",
        "group": "1b9713a7.a3a26c",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "x": 1000,
        "y": 980,
        "wires": [
            [
                "35891aa8.d828c6",
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "483d789b.9b7bd8",
        "type": "ui_slider",
        "z": "37daec28.284ee4",
        "name": "Helligkeit Tiffany",
        "label": "Helligkeit",
        "tooltip": "",
        "group": "1b9713a7.a3a26c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "all",
        "topic": "",
        "topicType": "str",
        "min": "20",
        "max": "254",
        "step": "25",
        "x": 1000,
        "y": 1060,
        "wires": [
            [
                "f74f051f.78aca8"
            ]
        ]
    },
    {
        "id": "f74f051f.78aca8",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = {\"brightness\": msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 1060,
        "wires": [
            [
                "40e09b5.33b3964"
            ]
        ]
    },
    {
        "id": "7e4ae382.f3381c",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 940,
        "wires": [
            [
                "30c5bc34.3c3974"
            ]
        ]
    },
    {
        "id": "9762023d.37de7",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = msg.payload.brightness;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 1020,
        "wires": [
            [
                "483d789b.9b7bd8"
            ]
        ]
    },
    {
        "id": "57017096.9ae36",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state ON_",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"ON\"}",
        "output": "json",
        "x": 620,
        "y": 1900,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "82751974.3c5238",
        "type": "mqtt out",
        "z": "37daec28.284ee4",
        "name": "Leuchter",
        "topic": "zigbee2mqtt/leuchter/set",
        "qos": "1",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 980,
        "y": 1900,
        "wires": []
    },
    {
        "id": "87c6eea5.de14c",
        "type": "mqtt in",
        "z": "37daec28.284ee4",
        "name": "Leuchter",
        "topic": "zigbee2mqtt/leuchter",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 1160,
        "y": 1900,
        "wires": [
            [
                "9b0a2d3d.d8a5f"
            ]
        ]
    },
    {
        "id": "9b0a2d3d.d8a5f",
        "type": "json",
        "z": "37daec28.284ee4",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 1310,
        "y": 1900,
        "wires": [
            [
                "7411287e.b145a8",
                "d2d0266a.cd3ee8",
                "11d236e2.b42379"
            ]
        ]
    },
    {
        "id": "d0098b99.ba82f8",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "state OFF",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"state\": \"OFF\"}",
        "output": "json",
        "x": 620,
        "y": 1940,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "7411287e.b145a8",
        "type": "change",
        "z": "37daec28.284ee4",
        "name": "save leuchter state",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload.state = 'ON' ? 'on' : 'off'",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "brightness",
                "pt": "msg",
                "to": "payload.brightness",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "leuchter",
                "pt": "flow",
                "to": "{'state': state, 'brightness': brightness}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 1940,
        "wires": [
            [
                "b46d4ee5.72901"
            ]
        ]
    },
    {
        "id": "95edc464.547d58",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "increment leuchter brightness",
        "func": "var leuchter = flow.get(\"leuchter\")\n\nleuchter[\"brightness\"] += 25;\nif (leuchter[\"brightness\"] > 254) {\n    leuchter[\"brightness\"] = 254;\n}\n\nflow.set(\"leuchter\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 690,
        "y": 1980,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "66e98b0e.c34604",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "decrement leuchter brightness",
        "func": "var leuchter = flow.get(\"leuchter\")\n\nleuchter[\"brightness\"] -= 10;\nif (leuchter[\"brightness\"] < 0) {\n    leuchter[\"brightness\"] = 0;\n}\nflow.set(\"leuchter\", leuchter);\n\nmsg.payload = {\"brightness\": leuchter[\"brightness\"]};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 690,
        "y": 2020,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "da091852.405428",
        "type": "switch",
        "z": "37daec28.284ee4",
        "name": "Action",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_down",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_max",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "brightness_min",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 6,
        "x": 430,
        "y": 2000,
        "wires": [
            [
                "57017096.9ae36"
            ],
            [
                "d0098b99.ba82f8"
            ],
            [
                "95edc464.547d58"
            ],
            [
                "66e98b0e.c34604"
            ],
            [
                "1fbf0b08.248be5"
            ],
            [
                "d941581f.0f0888"
            ]
        ],
        "outputLabels": [
            "brightness_up_click",
            "brightness_down_click",
            "",
            "",
            "",
            ""
        ]
    },
    {
        "id": "1fbf0b08.248be5",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 254",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 254}",
        "output": "json",
        "x": 640,
        "y": 2060,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "d941581f.0f0888",
        "type": "template",
        "z": "37daec28.284ee4",
        "name": "brightness 1",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\"brightness\": 1}",
        "output": "json",
        "x": 630,
        "y": 2100,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "b46d4ee5.72901",
        "type": "debug",
        "z": "37daec28.284ee4",
        "name": "Fensterbank",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1390,
        "y": 1980,
        "wires": []
    },
    {
        "id": "9aca83f0.327cd",
        "type": "ui_switch",
        "z": "37daec28.284ee4",
        "name": "An/Aus Leuchter Fernsehzimmer",
        "label": "An/Aus",
        "tooltip": "",
        "group": "b4675dbc.146e1",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "{\"state\": \"ON\"}",
        "onvalueType": "json",
        "onicon": "",
        "oncolor": "",
        "offvalue": "{\"state\": \"OFF\"}",
        "offvalueType": "json",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "x": 1060,
        "y": 2000,
        "wires": [
            [
                "b46d4ee5.72901",
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "546088f6.3a4488",
        "type": "ui_slider",
        "z": "37daec28.284ee4",
        "name": "Helligkeit Leuchter Fernsehzimmer",
        "label": "Helligkeit",
        "tooltip": "",
        "group": "b4675dbc.146e1",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "all",
        "topic": "",
        "topicType": "str",
        "min": "20",
        "max": "254",
        "step": "25",
        "x": 1060,
        "y": 2080,
        "wires": [
            [
                "b3e0dafa.e18c68"
            ]
        ]
    },
    {
        "id": "b3e0dafa.e18c68",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = {\"brightness\": msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 2080,
        "wires": [
            [
                "82751974.3c5238"
            ]
        ]
    },
    {
        "id": "d2d0266a.cd3ee8",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "state",
        "func": "msg.payload = {\"state\": msg.payload.state};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 1960,
        "wires": [
            [
                "9aca83f0.327cd"
            ]
        ]
    },
    {
        "id": "11d236e2.b42379",
        "type": "function",
        "z": "37daec28.284ee4",
        "name": "brightness",
        "func": "msg.payload = msg.payload.brightness;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 990,
        "y": 2040,
        "wires": [
            [
                "546088f6.3a4488"
            ]
        ]
    },
    {
        "id": "7ae7fa74.a8aa34",
        "type": "function",
        "z": "fc81a32b.bb6db",
        "name": "add absolute_humidity and dew_point",
        "func": "const temperature = msg.payload.temperature;\nconst humidity = msg.payload.humidity;\n\nconst mw = 18.01534;    // molar mass of water g/mol\nconst r = 8.31447215;   // Universal gas constant J/mol/K\n\nmsg.payload.absolute_humidity = (6.112 * Math.pow(2.718281828, (17.67 * temperature) /\n    (temperature + 243.5)) * humidity * mw) /\n    ((273.15 + temperature) * r); // in grams/m^3\n\nmsg.payload.dew_point = (243.5*(Math.log(humidity/100)+((17.67*temperature)/\n    (243.5+temperature)))/(17.67-Math.log(humidity/100)-\n    ((17.67*temperature)/(243.5+temperature))));\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 670,
        "y": 140,
        "wires": [
            [
                "56169d58.a0dc04"
            ]
        ]
    },
    {
        "id": "4708a180.a07a",
        "type": "link in",
        "z": "d0173d54.941d7",
        "name": "JSON to InfluxDB",
        "links": [
            "aa7a4964.384d28",
            "afb0333e.affc6"
        ],
        "x": 415,
        "y": 380,
        "wires": [
            [
                "bc2288b2.755178"
            ]
        ]
    },
    {
        "id": "aa7a4964.384d28",
        "type": "link out",
        "z": "fc81a32b.bb6db",
        "name": "",
        "links": [
            "4708a180.a07a"
        ],
        "x": 915,
        "y": 180,
        "wires": []
    },
    {
        "id": "54e7d479.9e81bc",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "Filter Sensors",
        "func": "if (!msg.topic.match(/aqara_smart|gas_zaehler/)) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 300,
        "wires": [
            [
                "fa0231fe.d86ab"
            ]
        ]
    },
    {
        "id": "87c5ced2.7998f",
        "type": "mqtt in",
        "z": "fc81a32b.bb6db",
        "name": "",
        "topic": "zigbee2mqtt/+",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 140,
        "y": 140,
        "wires": [
            [
                "d9d02903.582fc8",
                "a1cc7149.c8e29"
            ]
        ]
    },
    {
        "id": "d9d02903.582fc8",
        "type": "function",
        "z": "fc81a32b.bb6db",
        "name": "Filter Aqara Smart topics",
        "func": "if (msg.topic.match(/aqara_smart/)) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 140,
        "wires": [
            [
                "7ae7fa74.a8aa34"
            ]
        ]
    },
    {
        "id": "bc2288b2.755178",
        "type": "function",
        "z": "d0173d54.941d7",
        "name": "JSON to InfluxDB",
        "func": "const tokens = msg.topic.split(\"/\");\nconst measurement = tokens[1];\nmsg.measurement = measurement.replace(/ /g, '_').toLowerCase();\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 380,
        "wires": [
            [
                "faa25f7f.0777"
            ]
        ]
    },
    {
        "id": "a7ae9a7e.53fb48",
        "type": "function",
        "z": "fc81a32b.bb6db",
        "name": "Aqara Smart to global store",
        "func": "const name = msg.payload.name;\n\nglobal.set(`${name}-temperature`, msg.payload.temperature);\nglobal.set(`${name}-humidity`, msg.payload.humidity);\nglobal.set(`${name}-absolute_humidity`, msg.payload.absolute_humidity);\nglobal.set(`${name}-dew_point`, msg.payload.dew_point);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 820,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "fb6167b0.b1aeb8",
        "type": "debug",
        "z": "fc81a32b.bb6db",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 140,
        "wires": []
    },
    {
        "id": "f3d8ac5c.06b5d",
        "type": "mqtt in",
        "z": "fc81a32b.bb6db",
        "name": "",
        "topic": "+/sensor/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 140,
        "y": 80,
        "wires": [
            [
                "e9d35454.3632b8"
            ]
        ]
    },
    {
        "id": "e9d35454.3632b8",
        "type": "function",
        "z": "fc81a32b.bb6db",
        "name": "ESPHome to global store",
        "func": "const tokens = msg.topic.split(\"/\");\nconst name = tokens[0].replace(' ', '_');\nconst field = tokens[2].replace(' ', '_');\n\nconst value = (/^(\\-|\\+)?([0-9]+(\\.[0-9]+)?)$/.test(msg.payload))\n    ? Number(msg.payload) : msg.payload;\n\nglobal.set(`${name}-${field}`, value);\n\nreturn {payload: {\n    name: name,\n    field: field,\n    value: value\n}};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 80,
        "wires": [
            [
                "621bc9b5.3e4d28"
            ]
        ]
    },
    {
        "id": "2bf53ce9.7aa234",
        "type": "switch",
        "z": "2788b93b.8a2f56",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "aussen",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "zwitscherbox_bad",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "gaeste_wc",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "waschkueche_luefter",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "fahrradkeller",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "treppenhaus_keller",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "luftfeuchtemesser1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "wozi",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "kueche",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "speisekammer",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "schlafzimmer",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 11,
        "x": 1090,
        "y": 520,
        "wires": [
            [
                "5221a0c4.27e25"
            ],
            [
                "12ebb575.a874db"
            ],
            [
                "89e98409.0b1d08"
            ],
            [
                "8fc7d555.415c28"
            ],
            [
                "c91d5cbf.ecc24"
            ],
            [
                "740dd7e9.4e3008"
            ],
            [
                "f9ee87ab.ae2d38"
            ],
            [
                "f1e82e9a.000e8"
            ],
            [
                "961cf428.5c8238"
            ],
            [
                "668c6b28.38a1c4"
            ],
            [
                "593cbcc1.6b4944"
            ]
        ]
    },
    {
        "id": "c91d5cbf.ecc24",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 6,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "740dd7e9.4e3008",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "f1e82e9a.000e8",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 9,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "961cf428.5c8238",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 10,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "5221a0c4.27e25",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "d083875c.561678",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall klima draußen",
        "func": "const name = \"aussen\";\n\nconst temperature = global.get(name + \"-temperature\");\nconst humidity = global.get(name + \"-humidity\");\nconst abs_humidity = global.get(name + \"-absolute_humidity\");\nconst last_abs_humidity_gt_outside_abs_humidity = global.get(name + \"-last_abs_humidity_gt_outside_abs_humidity\");\nconst wozi_abs_humidity = global.get(\"wozi-absolute_humidity\");\n\n//node.warn(name)\n//node.warn(temperature)\n//node.warn(humidity)\n//node.warn(abs_humidity)\n//node.warn(last_abs_humidity_gt_outside_abs_humidity)\n//node.warn(outside_abs_humidity)\n\nconst intl = global.get('intl');\nconst format = intl.NumberFormat('de-De',{style:'decimal', maximumFractionDigits: 2}).format;\nconst sprintf = global.get(\"sprintf\");\nconst text = sprintf(\"%s °C, %s %% H, %s g/m³\", format(temperature), format(humidity), format(abs_humidity))\n\nif (abs_humidity > 13) {\n    return {payload: {name: name, color: \"deepskyblue\", hint: \"Draußen ist es sehr feucht.\", text: text}};\n} else if (abs_humidity > 12) {\n    return {payload: {name: name, color: \"skyblue\", hint: \"Draußen ist es feucht.\", text: text}};\n} else if (abs_humidity > 11) {\n    return {payload: {name: name, color: \"limegreen\", hint: \"Draußen ist einigermaßen trocken.\", text: text}};\n} else if (abs_humidity > 10) {\n    return {payload: {name: name, color: \"YellowGreen\", hint: \"Draußen ist es trocken.\", text: text}};\n} else {\n    return {payload: {name: name, color: \"DarkSeaGreen\", hint: \"Draußen ist es sehr trocken.\", text: text}};\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 340,
        "wires": [
            [
                "dac326a7.c5d638",
                "95ffdad4.8bfbc8"
            ]
        ]
    },
    {
        "id": "593cbcc1.6b4944",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 12,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "e28bca49.e88d18",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "waschkueche_luefter/sensor/temperature/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 240,
        "y": 120,
        "wires": [
            [
                "47eed9bd.a41b08"
            ]
        ]
    },
    {
        "id": "47eed9bd.a41b08",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "store global",
        "func": "var val = parseFloat(msg.payload);\nglobal.set(\"waschküche-temperature\", val);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "1547ac.8baef854",
        "type": "inject",
        "z": "4d90b497.b5b2ac",
        "name": "every 20 minutes",
        "props": [
            {
                "p": "topic",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "str",
        "x": 370,
        "y": 380,
        "wires": [
            [
                "a8931b52.026628"
            ]
        ]
    },
    {
        "id": "3fc26a03.2a8a06",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall zwitscherbox klima",
        "func": "const name = \"zwitscherbox_bad\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 420,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "3bab439b.dca5ec",
        "type": "inject",
        "z": "2788b93b.8a2f56",
        "name": "each 5 minutes",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "300",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 540,
        "wires": [
            [
                "3fc26a03.2a8a06",
                "d083875c.561678",
                "1a87dc90.70c533",
                "7de07eb2.117f4",
                "19b316c1.d916e9",
                "dc465da3.9f075",
                "1f972c48.e2ab94",
                "f54e3c81.4c057",
                "f477863d.bbbe58",
                "6604bb11.21e7b4",
                "800e50b3.1cd8f",
                "d97bb3fb.f95d7",
                "febd2e38.1a2e1"
            ]
        ]
    },
    {
        "id": "621bc9b5.3e4d28",
        "type": "debug",
        "z": "fc81a32b.bb6db",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 80,
        "wires": []
    },
    {
        "id": "40d6912.e35a67",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "initialize names-rooms mapping",
        "func": "const room = global.set(\"names_rooms\", {\n    \"zwitscherbox_bad\": \"Bad\",\n    \"luftfeuchtemesser1\": \"Werkstatt\",\n    \"gaeste_wc\": \"Gäste-WC\",\n    \"waschkueche_luefter\": \"Waschküche\",\n    \"wozi\": \"Wohnzimmer\",\n    \"kueche\": \"Küche\",\n    \"aussen\": \"Draußen\",\n    \"aussen_t\": \"Test\"\n});\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "2fa070d.b96fb9",
        "type": "inject",
        "z": "2788b93b.8a2f56",
        "name": "Reset",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 170,
        "y": 220,
        "wires": [
            [
                "40d6912.e35a67"
            ]
        ]
    },
    {
        "id": "56169d58.a0dc04",
        "type": "function",
        "z": "fc81a32b.bb6db",
        "name": "add name",
        "func": "const name = msg.topic.replace(/^zigbee2mqtt\\/aqara_smart_/, '').replace(' ', '_');\nmsg.payload.name = name;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 180,
        "wires": [
            [
                "a7ae9a7e.53fb48",
                "aa7a4964.384d28",
                "fb6167b0.b1aeb8"
            ]
        ]
    },
    {
        "id": "dac326a7.c5d638",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "add room",
        "func": "const name = msg.payload.name;\nconst names_rooms = global.get(\"names_rooms\");\nvar room = names_rooms[name] || name;\nroom = room\n    .split('_')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n    \nmsg.payload.room = room;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 860,
        "y": 520,
        "wires": [
            [
                "2bf53ce9.7aa234"
            ]
        ]
    },
    {
        "id": "ea8ce2c6.69dcd",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "var val = parseFloat(msg.payload);\n\nvar green = null, yellow = null, red = null;\n\nif (val < 35) {\n    green = val;\n} else if (val < 65) {\n    yellow = val;\n} else {\n    red = val;\n}\n\nmsg = [{\n        label: \"Luftfeuchtigkeit Werkstatt\",\n        series: \"green\",\n        payload: green\n    },\n    {\n        label: \"Luftfeuchtigkeit Werkstatt\",\n        series: \"yellow\",\n        payload: yellow\n    },\n    {\n        label: \"Luftfeuchtigkeit Werkstatt\",\n        series: \"red\",\n        payload: red\n    }\n];\n\nreturn msg;",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 580,
        "y": 220,
        "wires": [
            [
                "b2e1e7e.572a118"
            ],
            [
                "b2e1e7e.572a118"
            ],
            [
                "b2e1e7e.572a118"
            ]
        ]
    },
    {
        "id": "b2e1e7e.572a118",
        "type": "ui_chart",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Luftfeuchtigkeit",
        "group": "8240b43a.1094b8",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Luftfeuchtigkeit % rel.",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "warten auf Daten…",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "1",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#2ca02c",
            "#e6e600",
            "#d62728",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 860,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "a1cc7149.c8e29",
        "type": "debug",
        "z": "fc81a32b.bb6db",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 420,
        "y": 220,
        "wires": []
    },
    {
        "id": "1a87dc90.70c533",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall aussen_t klima",
        "func": "const name = \"aussen_t\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 380,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "7de07eb2.117f4",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall bad klima",
        "func": "const name = \"bad\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 460,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "19b316c1.d916e9",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall gaeste_wc klima",
        "func": "const name = \"gaeste_wc\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 500,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "dc465da3.9f075",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall waschkueche_luefter klima",
        "func": "const name = \"waschkueche_luefter\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 540,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "1f972c48.e2ab94",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall fahrradkeller klima",
        "func": "const name = \"fahrradkeller\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 580,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "f54e3c81.4c057",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall treppenhaus_keller klima",
        "func": "const name = \"treppenhaus_keller\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 620,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "f477863d.bbbe58",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall wozi klima",
        "func": "const name = \"wozi\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 700,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "6604bb11.21e7b4",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall kueche klima",
        "func": "const name = \"kueche\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 740,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "800e50b3.1cd8f",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall schlafzimmer klima",
        "func": "const name = \"schlafzimmer\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 820,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "35463b9.854cac4",
        "type": "debug",
        "z": "d0173d54.941d7",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1000,
        "y": 420,
        "wires": []
    },
    {
        "id": "a6b742da.b11dd",
        "type": "openweathermap in",
        "z": "293bb437.fa00bc",
        "name": "Wetter",
        "wtype": "current",
        "lon": "10.01239",
        "lat": "53.50597",
        "city": "",
        "country": "",
        "language": "de",
        "x": 130,
        "y": 440,
        "wires": [
            [
                "f562ddab.6a9d3"
            ]
        ]
    },
    {
        "id": "f562ddab.6a9d3",
        "type": "link out",
        "z": "293bb437.fa00bc",
        "name": "openweather",
        "links": [
            "9b9574d4.b3d108"
        ],
        "x": 235,
        "y": 440,
        "wires": []
    },
    {
        "id": "9f0ab131.1e302",
        "type": "ui_chart",
        "z": "4d90b497.b5b2ac",
        "name": "Waschküche Lüfterautomatik",
        "group": "8240b43a.1094b8",
        "order": 3,
        "width": "12",
        "height": "12",
        "label": "Waschküche Lüfterautomatik",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "2",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#9477bd",
            "#e6e600",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "x": 860,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "febd2e38.1a2e1",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall werkstatt (luftfeuchtemesser1) klima",
        "func": "const name = \"luftfeuchtemesser1\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 660,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "d97bb3fb.f95d7",
        "type": "function",
        "z": "2788b93b.8a2f56",
        "name": "recall speisekammer klima",
        "func": "const name = \"speisekammer\";\nreturn {\n    payload: {\n        name: name,\n        humidity: global.get(`${name}-humidity`),\n        absolute_humidity: global.get(`${name}-absolute_humidity`),\n        tempeature: global.get(`${name}-temperature`)\n    }\n};\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 780,
        "wires": [
            [
                "3825ae1b.6847c2"
            ]
        ]
    },
    {
        "id": "668c6b28.38a1c4",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 11,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "f9ee87ab.ae2d38",
        "type": "ui_template",
        "z": "2788b93b.8a2f56",
        "group": "245ec0f9.12765",
        "name": "",
        "order": 8,
        "width": 0,
        "height": 0,
        "format": "<md-card ui-card-size=\"6x2\" \n    class=\"_md nr-dashboard-text layout-align-center-center nr-dashboard-widget-text visible\" \n    style=\"background-color: {{msg.payload.color}}; color: black; left: 0px; top: 54px; width: 300px; height: 96px;\">\n    <p class=\"label\">{{msg.payload.room}}</p><p>{{msg.payload.text}}</p> <p class=\"value\">{{msg.payload.hint}}</p>\n</md-card>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 1320,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "33e8db68.d3a814",
        "type": "mqtt in",
        "z": "3a471104.edfbae",
        "name": "",
        "topic": "treppenhaus_keller/binary_sensor/button1/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 240,
        "y": 480,
        "wires": [
            [
                "9e0605ed.8497b8"
            ]
        ]
    },
    {
        "id": "9e0605ed.8497b8",
        "type": "function",
        "z": "3a471104.edfbae",
        "name": "toggle state",
        "func": "if (msg.payload != \"ON\") {\n    return undefined;\n}\n\nvar topic = \"treppenhaus_kellerlicht\";\nvar current_state = flow.get(topic);\n\nif (current_state === \"OFF\")\n    return {payload: \"ON\"}\nelse\n    return {payload: \"OFF\"};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 530,
        "y": 440,
        "wires": [
            [
                "3eb024a5.e9f9bc"
            ]
        ]
    },
    {
        "id": "8f0a4f28.6f3c4",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/binary_sensor/lueften/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 260,
        "y": 640,
        "wires": [
            [
                "949c2915.41cbb8"
            ]
        ]
    },
    {
        "id": "92c6f73d.d38e98",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/switch/servo/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1200,
        "y": 400,
        "wires": []
    },
    {
        "id": "341192ad.5f46be",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/switch/red/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1190,
        "y": 520,
        "wires": []
    },
    {
        "id": "febc79d8.468048",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/switch/yellow/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1200,
        "y": 560,
        "wires": []
    },
    {
        "id": "c8ee7404.bf05b8",
        "type": "mqtt out",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/switch/green/command",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1200,
        "y": 600,
        "wires": []
    },
    {
        "id": "3389cd6e.2de5b2",
        "type": "mqtt in",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "topic": "test_esp/binary_sensor/nicht_lueften/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "c349b9ff.9dc4c8",
        "x": 280,
        "y": 680,
        "wires": [
            [
                "cf2c65e2.59a078"
            ]
        ]
    },
    {
        "id": "949c2915.41cbb8",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "store flow",
        "func": "const val = msg.payload;\nflow.set(msg.topic, val);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 520,
        "y": 640,
        "wires": [
            [
                "aea42133.521d6"
            ]
        ]
    },
    {
        "id": "cf2c65e2.59a078",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "store flow",
        "func": "const val = msg.payload;\nflow.set(msg.topic, val);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 520,
        "y": 680,
        "wires": [
            [
                "aea42133.521d6"
            ]
        ]
    },
    {
        "id": "aea42133.521d6",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "const lueften = flow.get('test_esp/binary_sensor/lueften/state') == 'ON';\nconst nicht_lueften = flow.get('test_esp/binary_sensor/nicht_lueften/state') == 'ON';\nconst automatic = !lueften && !nicht_lueften;\n\nif (false) {\n    node.warn(`lueften: ${lueften}`);\n    node.warn(`nicht_lueften: ${lueften}`);\n    node.warn(`automatic: ${lueften}`);\n}\n\nreturn [\n    {payload: (lueften) ? 'ON' : 'OFF'},\n    {payload: (automatic) ? 'ON' : 'OFF'}\n];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 520,
        "wires": [
            [
                "74d29041.9a5c4",
                "3ed13b86.d374b4"
            ],
            [
                "d5fef74c.c342e8",
                "6d8574a6.5658ec"
            ]
        ]
    },
    {
        "id": "21f07479.c7da9c",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "not",
        "func": "return {payload: (msg.payload == 'ON' ? 'OFF' : 'ON')};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 950,
        "y": 520,
        "wires": [
            [
                "341192ad.5f46be"
            ]
        ]
    },
    {
        "id": "3ed13b86.d374b4",
        "type": "debug",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 500,
        "wires": []
    },
    {
        "id": "6d8574a6.5658ec",
        "type": "debug",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 540,
        "wires": []
    },
    {
        "id": "5a82383.d4d5ec8",
        "type": "mqtt in",
        "z": "2f328ad8.26ca86",
        "name": "",
        "topic": "zigbee2mqtt/gas_zaehler",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 250,
        "y": 400,
        "wires": [
            [
                "6238d883.2f3dd8"
            ]
        ]
    },
    {
        "id": "6238d883.2f3dd8",
        "type": "function",
        "z": "2f328ad8.26ca86",
        "name": "",
        "func": "if (msg.payload.contact) {\n    const topic = msg.topic;\n    var counter = (flow.get(topic) || 0) + 0.01;\n    flow.set(topic, counter);\n    return {topic: topic, payload: {counter: counter}};\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 400,
        "wires": [
            [
                "afb0333e.affc6",
                "cdbf2a81.584de8"
            ]
        ]
    },
    {
        "id": "a945560e.32cd08",
        "type": "fritz-thermostat",
        "z": "4d90b497.b5b2ac",
        "connection": "c2e6322e.33404",
        "name": "",
        "action": "getDevice",
        "x": 510,
        "y": 1180,
        "wires": [
            [
                "9f6756cf.150c28"
            ]
        ]
    },
    {
        "id": "1c2f8beb.29d2a4",
        "type": "inject",
        "z": "4d90b497.b5b2ac",
        "name": "inject heater_id",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "099950702018",
        "payload": "",
        "payloadType": "str",
        "x": 300,
        "y": 1140,
        "wires": [
            [
                "a945560e.32cd08"
            ]
        ]
    },
    {
        "id": "9f6756cf.150c28",
        "type": "debug",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 1180,
        "wires": []
    },
    {
        "id": "80e3bdcf.87103",
        "type": "function",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "func": "return {\n    payload: {hkr: {windowopenactiveendtime: \"1\"}},\n    topic: \"099950702018\"\n};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 280,
        "y": 1220,
        "wires": [
            [
                "a945560e.32cd08"
            ]
        ]
    },
    {
        "id": "b229.b9fe8dd748",
        "type": "inject",
        "z": "4d90b497.b5b2ac",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 1200,
        "wires": [
            [
                "80e3bdcf.87103"
            ]
        ]
    },
    {
        "id": "afb0333e.affc6",
        "type": "link out",
        "z": "2f328ad8.26ca86",
        "name": "Gas Zähler",
        "links": [
            "4708a180.a07a"
        ],
        "x": 595,
        "y": 400,
        "wires": []
    },
    {
        "id": "d7eb448b.d6abd8",
        "type": "ui_text",
        "z": "2f328ad8.26ca86",
        "group": "a8a6836d.1b1cf",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Zähler",
        "format": "{{msg.payload.counter}}",
        "layout": "row-spread",
        "x": 790,
        "y": 440,
        "wires": []
    },
    {
        "id": "b68c509.d70b4b",
        "type": "mqtt in",
        "z": "dac2cb3b.559138",
        "name": "",
        "topic": "zigbee2mqtt/bewegungsmelder_bad",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 220,
        "y": 140,
        "wires": [
            [
                "79b228de.d578d8"
            ]
        ]
    },
    {
        "id": "7b56cfeb.46625",
        "type": "mqtt out",
        "z": "dac2cb3b.559138",
        "name": "",
        "topic": "zigbee2mqtt/zirkulationspumpe/set",
        "qos": "",
        "retain": "",
        "broker": "c349b9ff.9dc4c8",
        "x": 1040,
        "y": 240,
        "wires": []
    },
    {
        "id": "7041ae49.67732",
        "type": "mqtt in",
        "z": "dac2cb3b.559138",
        "name": "",
        "topic": "zigbee2mqtt/bewegungsmelder_gaeste_wc",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 250,
        "y": 180,
        "wires": [
            [
                "79b228de.d578d8"
            ]
        ]
    },
    {
        "id": "38d9691b.b2f516",
        "type": "function",
        "z": "dac2cb3b.559138",
        "name": "map occupancy to ON",
        "func": "if (msg.payload[\"occupancy\"])\n    return {payload: \"ON\"};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 780,
        "y": 200,
        "wires": [
            [
                "d5f3f736.318c48"
            ]
        ]
    },
    {
        "id": "d5f3f736.318c48",
        "type": "ui_switch",
        "z": "dac2cb3b.559138",
        "name": "Zirkulationspumpe",
        "label": "Zirkulationspumpe",
        "tooltip": "",
        "group": "85193673.744e38",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "zirkulationspumpe",
        "topicType": "str",
        "style": "",
        "onvalue": "ON",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "OFF",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "x": 770,
        "y": 240,
        "wires": [
            [
                "dfc7c2ea.ec43",
                "7b56cfeb.46625"
            ]
        ]
    },
    {
        "id": "5f8f40ff.455c1",
        "type": "trigger",
        "z": "dac2cb3b.559138",
        "name": "5 Minuten-Timer",
        "op1": "",
        "op2": "OFF",
        "op1type": "nul",
        "op2type": "str",
        "duration": "5",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 860,
        "y": 320,
        "wires": [
            [
                "d5f3f736.318c48"
            ]
        ]
    },
    {
        "id": "dfc7c2ea.ec43",
        "type": "function",
        "z": "dac2cb3b.559138",
        "name": "filter ON",
        "func": "if (msg.payload === \"ON\")\n    return {payload: \"ON\"}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 680,
        "y": 320,
        "wires": [
            [
                "5f8f40ff.455c1"
            ]
        ]
    },
    {
        "id": "1f4ec988.5e9d16",
        "type": "mqtt in",
        "z": "dac2cb3b.559138",
        "name": "",
        "topic": "zigbee2mqtt/bewegungsmelder_kueche",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 240,
        "y": 220,
        "wires": [
            [
                "79b228de.d578d8"
            ]
        ]
    },
    {
        "id": "9daf226d.1f43e",
        "type": "mqtt in",
        "z": "dac2cb3b.559138",
        "name": "",
        "topic": "zigbee2mqtt/bewegungsmelder_bad_dg",
        "qos": "2",
        "datatype": "json",
        "broker": "c349b9ff.9dc4c8",
        "x": 240,
        "y": 260,
        "wires": [
            [
                "79b228de.d578d8"
            ]
        ]
    },
    {
        "id": "ff9d667f.fa9df8",
        "type": "function",
        "z": "2f328ad8.26ca86",
        "name": "",
        "func": "if (msg.payload.counter) {\n    flow.set(msg.topic, msg.payload.counter);\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 480,
        "wires": [
            [
                "cdbf2a81.584de8"
            ]
        ]
    },
    {
        "id": "231f1768.7a5958",
        "type": "inject",
        "z": "2f328ad8.26ca86",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "zigbee2mqtt/gas_zaehler",
        "payload": "{\"counter\": 4302.64}",
        "payloadType": "json",
        "x": 250,
        "y": 480,
        "wires": [
            [
                "ff9d667f.fa9df8"
            ]
        ]
    },
    {
        "id": "cdbf2a81.584de8",
        "type": "function",
        "z": "2f328ad8.26ca86",
        "name": "",
        "func": "const intl = global.get('intl');\nmsg.payload.counter = intl.NumberFormat('de-De',{\n        style:'decimal', \n        maximumFractionDigits: 2,\n        minimumFractionDigits: 2\n    }).format(msg.payload.counter) + \" m³\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 640,
        "y": 440,
        "wires": [
            [
                "d7eb448b.d6abd8"
            ]
        ]
    },
    {
        "id": "137fe45c.47150c",
        "type": "function",
        "z": "2f328ad8.26ca86",
        "name": "",
        "func": "const intl = global.get('intl');\nmsg.payload = intl.NumberFormat('de-De',{\n        style:'decimal', \n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n    }).format(msg.payload) + \" kWh\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 240,
        "wires": [
            [
                "a135ae90.6531b"
            ]
        ]
    },
    {
        "id": "a135ae90.6531b",
        "type": "ui_text",
        "z": "2f328ad8.26ca86",
        "group": "dab59e38.c408e",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Zähler",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 750,
        "y": 240,
        "wires": []
    },
    {
        "id": "3ca20e83.001932",
        "type": "inject",
        "z": "2788b93b.8a2f56",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 700,
        "wires": [
            [
                "6604bb11.21e7b4"
            ]
        ]
    },
    {
        "id": "d0850296.f2a0f",
        "type": "thingzi-timer",
        "z": "293bb437.fa00bc",
        "name": "Licht aus",
        "lat": "50.882",
        "lon": "6.6949",
        "timerType": "onoff",
        "startupMessage": true,
        "ontype": "tod",
        "ontimesun": "dusk",
        "ontimetod": "",
        "onpropertytype": "msg",
        "onproperty": "payload",
        "onvaluetype": "str",
        "onvalue": "ON",
        "onoffset": "",
        "onrandomoffset": false,
        "offtype": "tod",
        "offtimesun": "dawn",
        "offtimetod": "23:00",
        "offpropertytype": "msg",
        "offproperty": "payload",
        "offvaluetype": "str",
        "offvalue": "OFF",
        "offoffset": "",
        "offrandomoffset": false,
        "mon": true,
        "tue": true,
        "wed": true,
        "thu": true,
        "fri": true,
        "sat": true,
        "sun": true,
        "x": 540,
        "y": 200,
        "wires": [
            [
                "7e1d2b18.0c9484",
                "eabff51d.1ce108"
            ]
        ]
    },
    {
        "id": "95ffdad4.8bfbc8",
        "type": "time-of-day",
        "z": "2788b93b.8a2f56",
        "name": "",
        "startTime": "07:30:00",
        "endTime": "22:30:00",
        "outputs": 2,
        "x": 870,
        "y": 340,
        "wires": [
            [
                "92221171.b4219"
            ],
            []
        ]
    },
    {
        "id": "79b228de.d578d8",
        "type": "time-of-day",
        "z": "dac2cb3b.559138",
        "name": "",
        "startTime": "05:00:00",
        "endTime": "22:00:00",
        "outputs": 2,
        "x": 570,
        "y": 200,
        "wires": [
            [
                "38d9691b.b2f516"
            ],
            []
        ]
    }
]